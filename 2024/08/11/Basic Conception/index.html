<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="t-oxZCSyusW8fpJTSnIeMX4mPW2cDcw_lPHmaBBGC8w">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic%7CRoboto+Slab:300,300italic,400,400italic,700,700italic%7CPT+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.20.0","exturl":true,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"flat"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"changyan","storage":true,"lazyload":false,"nav":null,"activeClass":"changyan"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Fine-tune Q&amp;A 1dataset 123456789DatasetDict(&#123;train: Dataset(&#123;    features: [&#x27;id&#x27;, &#x27;title&#x27;, &#x27;context&#x27;, &#x27;question&#x27;, &#x27;answers&#x27;],    num_r">
<meta property="og:type" content="blog">
<meta property="og:title" content="Q&amp;A dataset Fine-tune">
<meta property="og:url" content="http://example.com/2024/08/11/Basic%20Conception/index.html">
<meta property="og:site_name" content="Jason&#39;s Blog">
<meta property="og:description" content="Fine-tune Q&amp;A 1dataset 123456789DatasetDict(&#123;train: Dataset(&#123;    features: [&#x27;id&#x27;, &#x27;title&#x27;, &#x27;context&#x27;, &#x27;question&#x27;, &#x27;answers&#x27;],    num_r">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-08-11T11:21:24.789Z">
<meta property="article:modified_time" content="2024-08-12T09:09:47.374Z">
<meta property="article:author" content="Jason Li">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2024/08/11/Basic%20Conception/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2024/08/11/Basic%20Conception/","path":"2024/08/11/Basic Conception/","title":"Q&A dataset Fine-tune"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Q&A dataset Fine-tune | Jason's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Jason's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Give More, Expect Less</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">5</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">0</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">0</span></a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#fine-tune-qa"><span class="nav-text">Fine-tune Q&amp;A</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E5%85%83%E7%B4%A0%E8%A7%A3%E9%87%8A"><span class="nav-text">1. 数据集元素解释</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%91%E9%80%89%E5%8D%81%E4%B8%AA%E6%A0%B7%E6%9C%AC"><span class="nav-text">2. 挑选十个样本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%84%E7%90%86%E9%95%BF%E6%96%87%E6%9C%AC"><span class="nav-text">2. 处理长文本</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E7%AD%94%E6%A1%88%E4%BD%8D%E7%BD%AE"><span class="nav-text">2.1 寻找答案位置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%BE%E5%88%B0%E7%AD%94%E6%A1%88%E5%9C%A8%E6%96%87%E4%B8%AD%E7%9A%84index%E5%80%BC"><span class="nav-text">找到答案在文中的index值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AE%E8%AE%A4%E5%A4%9A%E4%B8%AA%E7%89%B9%E5%BE%81%E4%B8%AD%E6%98%AF%E5%90%A6%E5%8C%85%E5%90%AB%E7%AD%94%E6%A1%88%E6%9C%80%E5%90%8E%E7%94%A80"><span class="nav-text">2.3
确认多个特征中是否包含答案，最后用0</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%96%E5%B0%8F%E5%9E%8B%E6%95%B0%E6%8D%AE%E9%9B%86%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="nav-text">2.4 取小型数据集的方式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0"><span class="nav-text">3 模型评估</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Jason Li"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">Jason Li</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">5</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3lvdXJuYW1l" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yourname"><i class="fab fa-github fa-fw"></i></span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOnlvdXJuYW1lQGdtYWlsLmNvbQ==" title="E-Mail → mailto:yourname@gmail.com"><i class="fa fa-envelope fa-fw"></i></span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="fab fa-twitter fa-fw"></i></span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly95b3V0dWJlLmNvbS95b3VybmFtZQ==" title="YouTube → https:&#x2F;&#x2F;youtube.com&#x2F;yourname"><i class="fab fa-youtube fa-fw"></i></span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/08/11/Basic%20Conception/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jason Li">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Q&A dataset Fine-tune | Jason's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Q&A dataset Fine-tune<span class="exturl post-edit-link" data-url="aHR0cHM6Ly9naXRodWIuY29tL3VzZXItbmFtZS9yZXBvLW5hbWUvdHJlZS9icmFuY2gtbmFtZS9zdWJkaXJlY3RvcnktbmFtZS9fcG9zdHMvQmFzaWMgQ29uY2VwdGlvbi5tZA==" title="Edit this post"><i class="fa fa-pen-nib"></i></span>
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-08-11 19:21:24" itemprop="dateCreated datePublished" datetime="2024-08-11T19:21:24+08:00">2024-08-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-08-12 17:09:47" itemprop="dateModified" datetime="2024-08-12T17:09:47+08:00">2024-08-12</time>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    <a title="Q&A dataset Fine-tune" href="/2024/08/11/Basic%20Conception/#SOHUCS" itemprop="discussionUrl">
      <span id="sourceId::20d24e3db4486a54af4fc258a9dc5374" class="cy_cmt_count" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>7.5k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>27 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="fine-tune-qa">Fine-tune Q&amp;A</h1>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dataset</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DatasetDict(&#123;</span><br><span class="line">train: Dataset(&#123;</span><br><span class="line">    features: [&#x27;id&#x27;, &#x27;title&#x27;, &#x27;context&#x27;, &#x27;question&#x27;, &#x27;answers&#x27;],</span><br><span class="line">    num_rows: 87599</span><br><span class="line">    &#125;)</span><br><span class="line">validation: Dataset(&#123;</span><br><span class="line">    features: [&#x27;id&#x27;, &#x27;title&#x27;, &#x27;context&#x27;, &#x27;question&#x27;, &#x27;answers&#x27;],</span><br><span class="line">    num_rows: 10570</span><br><span class="line">    &#125;) &#125;）</span><br></pre></td></tr></table></figure>
<ul>
<li>这个SQuAD数据集比之前的数据集新增了更多的特征， <strong>context,
question,
answers</strong>，并且训练所能够识别的训练集必须满足dataset的数据集格式</li>
</ul>
<ol type="1">
<li><p>斯坦福问答数据集(SQuAD)
是一个阅读理解数据集，由众包工作者在一系列维基百科文章上提出问题组成。每个问题的答案都是相应阅读段落中的文本片段或范围，<strong>或者该问题可能无法回答。</strong></p></li>
<li><p>SQuAD2.0将SQuAD1.1中的10万个问题与由众包工作者对抗性<a
href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a>地撰写的<strong>5万多个无法回答的问题相结合</strong>，使其看起来与可回答的问题类似。<strong><em>要在SQuAD2.0上表现良好，系统不仅必须在可能时回答问题，还必须确定段落中没有支持任何答案，并放弃回答.</em></strong>
<span id="more"></span> <strong><font color="red" size = 2>
以上加租或者斜体文字将会在训练，模型评估代码中体现
</font></strong></p></li>
</ol>
<h2 id="数据集元素解释">1. 数据集元素解释</h2>
<pre><code>&#123;&#39;id&#39;: &#39;5733be284776f41900661182&#39;,
&#39;title&#39;: &#39;University_of_Notre_Dame&#39;,
&#39;context&#39;: &#39;Architecturally, the school has a Catholic character. Atop the Main Building\&#39;s gold dome is a golden statue of the Virgin Mary. Immediately in front of the Main Building and facing it, is a copper statue of Christ with arms upraised with the legend &quot;Venite Ad Me Omnes&quot;. Next to the Main Building is the Basilica of the Sacred Heart. Immediately behind the basilica is the Grotto, a Marian place of prayer and reflection. It is a replica of the grotto at Lourdes, France where the Virgin Mary reputedly appeared to Saint Bernadette Soubirous in 1858. At the end of the main drive (and in a direct line that connects through 3 statues and the Gold Dome), is a simple, modern stone statue of Mary.&#39;,
&#39;question&#39;: &#39;To whom did the Virgin Mary allegedly appear in 1858 in Lourdes France?&#39;,
&#39;answers&#39;: &#123;&#39;text&#39;: [&#39;Saint Bernadette Soubirous&#39;], &#39;answer_start&#39;: [515]&#125;</code></pre>
<p><strong>question</strong>:通常和context上下文放在一起由tokenizer进行分词，作为两个部分，通过CLS作为序列开头，用SEP间隔作为两个部分。</p>
<p><strong>context</strong>:指的是上下文，针对过长文本会进行，截断策略，标记，填充策略</p>
<p><strong>answer</strong>:包含两个键值，<strong>text</strong> 和
<strong>answer_start</strong> .
前者指的是文本中对应的答案是什么，后者指的是这个答案的第一个字母所在整个上下文的位置。会用来确定正确答案在上下文和问题中的index.</p>
<h2 id="挑选十个样本">2. 挑选十个样本</h2>
<pre><code>from datasets import ClassLabel, Sequence
import random
import pandas as pd
from IPython.display import display, HTML</code></pre>
<ul>
<li>导入了一些库</li>
</ul>
<ol type="1">
<li><p>classlabel, 用于整数映射字符串标签</p></li>
<li><p>sequence, 用于标示序列中的元素</p></li>
<li><p>random 和 pandas， 用于生成随机数，提供Dataframe 和 series
的数据结构来处理结构化数据</p></li>
<li><p>display，HTML 用于渲染HTML在python中</p></li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">show_random_elements</span>(<span class="params">dataset, num_examples=<span class="number">10</span></span>):</span><br><span class="line">    <span class="keyword">assert</span> num_examples &lt;= <span class="built_in">len</span>(dataset), <span class="string">&quot;Can&#x27;t pick more elements than there are in the dataset.&quot;</span></span><br><span class="line">    picks = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(num_examples):</span><br><span class="line">        pick = random.randint(<span class="number">0</span>, <span class="built_in">len</span>(dataset)-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">while</span> pick <span class="keyword">in</span> picks:</span><br><span class="line">            pick = random.randint(<span class="number">0</span>, <span class="built_in">len</span>(dataset)-<span class="number">1</span>)</span><br><span class="line">        picks.append(pick)</span><br><span class="line">    df = pd.DataFrame(dataset[picks])</span><br><span class="line">    <span class="keyword">for</span> column, typ <span class="keyword">in</span> dataset.features.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(typ, ClassLabel):</span><br><span class="line">            df[column] = df[column].transform(<span class="keyword">lambda</span> i: typ.names[i])</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">isinstance</span>(typ, <span class="type">Sequence</span>) <span class="keyword">and</span> <span class="built_in">isinstance</span>(typ.feature, ClassLabel):</span><br><span class="line">            df[column] = df[column].transform(<span class="keyword">lambda</span> x: [typ.feature.names[i] <span class="keyword">for</span> i <span class="keyword">in</span> x])</span><br><span class="line">    display(HTML(df.to_html()))</span><br></pre></td></tr></table></figure>
<ul>
<li><p>这段代码先确定随机样本不会超过，dataset，然后建立pick列表通过嵌套循环来确保示例的随机性</p></li>
<li><p>随后用进行对feature列表中的元素进行特征检查，排除Classlabel 和
Sequence 以及序列的内部特征是不是classlabel <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> AutoTokenizer </span><br><span class="line">tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> transformers</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">isinstance</span>(tokenizer, transformers.PreTrainedTokenizerFast)</span><br><span class="line"></span><br><span class="line">tokenizer(<span class="string">&quot;What is your name?&quot;</span>, <span class="string">&quot;My name is Sylvain.&quot;</span>)</span><br></pre></td></tr></table></figure>
这段代码使用自动分词器</p>
<pre><code>  &#123;&#39;input_ids&#39;: [101, 2054, 2003, 2115, 2171, 1029, 102, 2026, 2171, 2003, 25353, 22144, 2378, 1012, 102], &#39;attention_mask&#39;: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]&#125;</code></pre>
<p>内部包含input_ids, 这个键会与offset_mapping 的功能结合使用。</p></li>
</ul>
<h2 id="处理长文本">2. 处理长文本</h2>
<ul>
<li>arguments 解释 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tokenized_example = tokenizer(</span><br><span class="line">    example[<span class="string">&quot;question&quot;</span>],</span><br><span class="line">    example[<span class="string">&quot;context&quot;</span>],</span><br><span class="line">    max_length=max_length,</span><br><span class="line">    truncation=<span class="string">&quot;only_second&quot;</span>,</span><br><span class="line">    return_overflowing_tokens=<span class="literal">True</span>,</span><br><span class="line">    return_offsets_mapping=<span class="literal">True</span>,</span><br><span class="line">    stride=doc_stride</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
以上是标示分词器的参数，tokenizer会将question和context作为两个部分
存放到一个序列当中。</li>
</ul>
<blockquote>
<p>max_length = max_length</p>
</blockquote>
<p>会根据设定好的参数值进行截断,
截断后分词器会将两个部分用列表的形式存在一个列表中</p>
<blockquote>
<p>truncation="only_second"</p>
</blockquote>
<p>表示只会截断第二部分即context，保留第一部分，两个列表中都会包含第一部分</p>
<blockquote>
<p>return_overflowing_token=True</p>
</blockquote>
<p>会根据截断来返回特征，一个示例会包含两个或两个以上的特征，同时在分词器的字典中会产生一对新的键对值，overflow_to_sample_mapping，里面是储存两个特征相对于示例的索引。</p>
<blockquote>
<p>stride=doc_stride</p>
</blockquote>
<p>这个指的是长文本截断后后一个向前一个向前偏移的结果，
即对于特征来说，两个相邻的特征的context部分要有一定的重合，这保证的上下文的连贯性，同时也为后续的模型评估和多特征处理提供了便捷。</p>
<blockquote>
<p>return_offsets_mapping=True</p>
</blockquote>
<p>映射指的是将关于分词器的对序列的处理后，对于序列中的元素进行字符位置的映射，针对每个单词起始字符和结束字符用元组进行保存。每个特征也会有对应的列表，跟inputs_id
对多个特征的存储方式相同。</p>
<p>CLS SEP特殊标记符号用（0，0）。</p>
<h3 id="寻找答案位置">2.1 寻找答案位置</h3>
<p><strong>参数设置</strong></p>
<blockquote>
<p>max_length = 384</p>
</blockquote>
<blockquote>
<p>doc_stride = 128</p>
</blockquote>
<p><strong>区分token来源</strong></p>
<blockquote>
<p>sequence_ids = tokenized_example.sequence_ids()</p>
</blockquote>
<blockquote>
<p>print(sequence_ids)</p>
</blockquote>
<p>这段代码会返回0 和 1 组成的列表 0标示question，1 标示context，
None标示CLS，SEP</p>
<pre><code>[None, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, None, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, None]</code></pre>
<h3 id="找到答案在文中的index值">找到答案在文中的index值</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">answers = example[<span class="string">&quot;answers&quot;</span>]</span><br><span class="line">start_char = answers[<span class="string">&quot;answer_start&quot;</span>][<span class="number">0</span>]</span><br><span class="line">end_char = start_char + <span class="built_in">len</span>(answers[<span class="string">&quot;text&quot;</span>][<span class="number">0</span>])</span><br></pre></td></tr></table></figure>
<p><strong>定义初始值，找到答案的开始和结束字符位置</strong>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">token_start_index = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> sequence_ids[token_start_index] != <span class="number">1</span>:</span><br><span class="line">    token_start_index += <span class="number">1</span></span><br></pre></td></tr></table></figure> <strong>找到token的开始index</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">token_end_index = <span class="built_in">len</span>(tokenized_example[<span class="string">&quot;input_ids&quot;</span>][<span class="number">0</span>]) - <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> sequence_ids[token_end_index] != <span class="number">1</span>:</span><br><span class="line">    token_end_index -= <span class="number">1</span></span><br></pre></td></tr></table></figure>
<strong>找到token的结束index</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">offsets = tokenized_example[<span class="string">&quot;offset_mapping&quot;</span>][<span class="number">0</span>]</span><br><span class="line"><span class="keyword">if</span> (offsets[token_start_index][<span class="number">0</span>] &lt;= start_char <span class="keyword">and</span> offsets[token_end_index][<span class="number">1</span>] &gt;= end_char):</span><br><span class="line">        <span class="comment"># 将token_start_index和token_end_index移动到答案的两端。</span></span><br><span class="line">        <span class="comment"># 注意：如果答案是最后一个单词，我们可以移到最后一个标记之后（边界情况）。</span></span><br><span class="line">    <span class="keyword">while</span> token_start_index &lt; <span class="built_in">len</span>(offsets) <span class="keyword">and</span> offse[token_start_index][<span class="number">0</span>] &lt;= start_char:</span><br><span class="line">        token_start_index += <span class="number">1</span></span><br><span class="line">    start_position = token_start_index - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> offsets[token_end_index][<span class="number">1</span>] &gt;= end_char:</span><br><span class="line">        token_end_index -= <span class="number">1</span></span><br><span class="line">    end_position = token_end_index + <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(start_position, end_position)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;答案不在此特征中。&quot;</span>)</span><br></pre></td></tr></table></figure>
<strong>这段代码引入映射值，通过循环逐步将index偏移到答案对应的index，循环停止的标记是单词所在index中的开始字符位置大于答案时则停止，所以要最后计算位置要减一，反之亦然。</strong></p>
<h3 id="确认多个特征中是否包含答案最后用0">2.3
确认多个特征中是否包含答案，最后用0</h3>
<ul>
<li>上下文过长, 答案在另一个特征中, 在开始和结束位置都设置了cls索引</li>
<li>allow_impossible_answers标志为False, 我们可以直接丢弃示例</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">prepare_validation_features</span>(<span class="params">examples</span>):</span><br><span class="line"><span class="comment"># 一些问题的左侧有很多空白，这些空白并不有用且会导致上下文截断失败（分词后的问题会占用很多空间）。</span></span><br><span class="line"><span class="comment"># 因此我们移除这些左侧空白</span></span><br><span class="line">examples[<span class="string">&quot;question&quot;</span>] = [q.lstrip() <span class="keyword">for</span> q <span class="keyword">in</span> examples[<span class="string">&quot;question&quot;</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用截断和可能的填充对我们的示例进行分词，但使用步长保留溢出的令牌。这导致一个长上下文的示例可能产生</span></span><br><span class="line"><span class="comment"># 几个特征，每个特征的上下文都会稍微与前一个特征的上下文重叠。</span></span><br><span class="line">tokenized_examples = tokenizer(</span><br><span class="line">    examples[<span class="string">&quot;question&quot;</span> <span class="keyword">if</span> pad_on_right <span class="keyword">else</span> <span class="string">&quot;context&quot;</span>],</span><br><span class="line">    examples[<span class="string">&quot;context&quot;</span> <span class="keyword">if</span> pad_on_right <span class="keyword">else</span> <span class="string">&quot;question&quot;</span>],</span><br><span class="line">    truncation=<span class="string">&quot;only_second&quot;</span> <span class="keyword">if</span> pad_on_right <span class="keyword">else</span> <span class="string">&quot;only_first&quot;</span>,</span><br><span class="line">    max_length=max_length,</span><br><span class="line">    stride=doc_stride,</span><br><span class="line">    return_overflowing_tokens=<span class="literal">True</span>,</span><br><span class="line">    return_offsets_mapping=<span class="literal">True</span>,</span><br><span class="line">    padding=<span class="string">&quot;max_length&quot;</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p><strong>填充是指将每个序列的长度都保持一致,
包括被截断的部分</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 由于一个示例在上下文很长时可能会产生几个特征，我们需要一个从特征映射到其对应示例的映射。这个键就是为了这个目的。</span></span><br><span class="line">sample_mapping = tokenized_examples.pop(<span class="string">&quot;overflow_to_sample_mapping&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><strong>这个sample_mapping
是表示一个列表，存储的是对应的示例的索引，例如[0,1,1],
0表示一个示例，两个1表示，一个示例中包含两个特征</strong>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 我们保留产生这个特征的示例ID，并且会存储偏移映射。</span></span><br><span class="line">tokenized_examples[<span class="string">&quot;example_id&quot;</span>] = []</span><br><span class="line">        </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tokenized_examples[<span class="string">&quot;input_ids&quot;</span>])):</span><br><span class="line">    <span class="comment"># 获取与该示例对应的序列（以了解哪些是上下文，哪些是问题）。</span></span><br><span class="line">    sequence_ids = tokenized_examples.sequence_ids(i)</span><br><span class="line">    context_index = <span class="number">1</span> <span class="keyword">if</span> pad_on_right <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 一个示例可以产生几个文本段，这里是包含该文本段的示例的索引。</span></span><br><span class="line">    sample_index = sample_mapping[i]</span><br><span class="line">    tokenized_examples[<span class="string">&quot;example_id&quot;</span>].append(examples[<span class="string">&quot;id&quot;</span>][sample_index])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将不属于上下文的偏移映射设置为None，以便容易确定一个令牌位置是否属于上下文。</span></span><br><span class="line">    tokenized_examples[<span class="string">&quot;offset_mapping&quot;</span>][i] = [</span><br><span class="line">        (o <span class="keyword">if</span> sequence_ids[k] == context_index <span class="keyword">else</span> <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">for</span> k, o <span class="keyword">in</span> <span class="built_in">enumerate</span>(tokenized_examples[<span class="string">&quot;offset_mapping&quot;</span>][i])</span><br><span class="line">            ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tokenized_examples</span><br></pre></td></tr></table></figure></p>
<p><strong>example for： two lists ，first&lt;384,
second&gt;384</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;input_ids&#x27;</span>: [[<span class="number">101</span>, <span class="number">2006</span>, <span class="number">2054</span>, <span class="number">2154</span>, <span class="number">2079</span>, <span class="number">10289</span>, <span class="number">8214</span>, <span class="number">2188</span>, <span class="number">2374</span>, <span class="number">2399</span>, <span class="number">5258</span>, <span class="number">1029</span>, <span class="number">102</span>, <span class="number">2374</span>, <span class="number">2208</span>, <span class="number">10259</span>, <span class="number">7443</span>, <span class="number">2076</span>, <span class="number">2188</span>, <span class="number">2399</span>, <span class="number">1010</span>, <span class="number">3450</span>, <span class="number">5258</span>, <span class="number">2035</span>, <span class="number">2105</span>, <span class="number">3721</span>, <span class="number">1998</span>, <span class="number">2367</span>, <span class="number">19568</span>, <span class="number">2015</span>, <span class="number">29460</span>, <span class="number">2037</span>, <span class="number">9873</span>, <span class="number">2007</span>, <span class="number">1037</span>, <span class="number">3151</span>, <span class="number">8875</span>, <span class="number">1006</span>, <span class="number">1041</span>, <span class="number">1012</span>, <span class="number">1043</span>, <span class="number">1012</span>, <span class="number">23564</span>, <span class="number">14227</span>, <span class="number">2160</span>, <span class="number">1005</span>, <span class="number">1055</span>, <span class="number">2048</span>, <span class="number">1011</span>, <span class="number">2466</span>, <span class="number">9484</span>, <span class="number">1007</span>, <span class="number">1012</span>, <span class="number">3151</span>, <span class="number">3450</span>, <span class="number">4088</span>, <span class="number">2012</span>, <span class="number">1996</span>, <span class="number">6909</span>, <span class="number">1997</span>, <span class="number">7090</span>, <span class="number">2007</span>, <span class="number">1996</span>, <span class="number">7101</span>, <span class="number">2015</span>, <span class="number">1005</span>, <span class="number">4418</span>, <span class="number">1012</span>, <span class="number">2023</span>, <span class="number">4535</span>, <span class="number">7336</span>, <span class="number">1996</span>, <span class="number">6943</span>, <span class="number">2240</span>, <span class="number">1997</span>, <span class="number">1996</span>, <span class="number">2316</span>, <span class="number">1997</span>, <span class="number">1996</span>, <span class="number">3554</span>, <span class="number">3493</span>, <span class="number">1998</span>, <span class="number">20774</span>, <span class="number">2015</span>, <span class="number">1999</span>, <span class="number">1996</span>, <span class="number">2717</span>, <span class="number">1997</span>, <span class="number">1996</span>, <span class="number">21206</span>, <span class="number">2008</span>, <span class="number">2097</span>, <span class="number">3613</span>, <span class="number">1996</span>, <span class="number">2717</span>, <span class="number">1997</span>, <span class="number">1996</span>, <span class="number">2208</span>, <span class="number">10259</span>, <span class="number">5095</span>, <span class="number">1012</span>, <span class="number">2101</span>, <span class="number">2008</span>, <span class="number">2154</span>, <span class="number">1010</span>, <span class="number">1996</span>, <span class="number">9368</span>, <span class="number">2930</span>, <span class="number">2097</span>, <span class="number">2377</span>, <span class="number">1996</span>, <span class="number">10289</span>, <span class="number">8214</span>, <span class="number">3377</span>, <span class="number">2233</span>, <span class="number">1998</span>, <span class="number">1996</span>, <span class="number">10289</span>, <span class="number">8214</span>, <span class="number">11346</span>, <span class="number">16289</span>, <span class="number">2104</span>, <span class="number">1996</span>, <span class="number">8514</span>, <span class="number">1012</span>, <span class="number">1996</span>, <span class="number">2316</span>, <span class="number">2972</span>, <span class="number">2097</span>, <span class="number">2377</span>, <span class="number">1037</span>, <span class="number">4164</span>, <span class="number">2012</span>, <span class="number">1996</span>, <span class="number">4084</span>, <span class="number">1997</span>, <span class="number">5416</span>, <span class="number">2534</span>, <span class="number">1010</span>, <span class="number">2013</span>, <span class="number">2073</span>, <span class="number">2027</span>, <span class="number">2097</span>, <span class="number">2233</span>, <span class="number">2046</span>, <span class="number">10289</span>, <span class="number">8214</span>, <span class="number">3346</span>, <span class="number">1010</span>, <span class="number">2877</span>, <span class="number">4599</span>, <span class="number">1998</span>, <span class="number">2493</span>, <span class="number">11455</span>, <span class="number">2408</span>, <span class="number">3721</span>, <span class="number">2000</span>, <span class="number">1996</span>, <span class="number">2208</span>, <span class="number">1012</span>, <span class="number">102</span>], [<span class="number">101</span>, <span class="number">2129</span>, <span class="number">2116</span>, <span class="number">5222</span>, <span class="number">2515</span>, <span class="number">1996</span>, <span class="number">10289</span>, <span class="number">8214</span>, <span class="number">2273</span>, <span class="number">1005</span>, <span class="number">1055</span>, <span class="number">3455</span>, <span class="number">2136</span>, <span class="number">2031</span>, <span class="number">1029</span>, <span class="number">102</span>, <span class="number">1996</span>, <span class="number">2273</span>, <span class="number">1005</span>, <span class="number">1055</span>, <span class="number">3455</span>, <span class="number">2136</span>, <span class="number">2038</span>, <span class="number">2058</span>, <span class="number">1015</span>, <span class="number">1010</span>, <span class="number">5174</span>, <span class="number">5222</span>, <span class="number">1010</span>, <span class="number">2028</span>, <span class="number">1997</span>, <span class="number">2069</span>, <span class="number">2260</span>, <span class="number">2816</span>, <span class="number">2040</span>, <span class="number">2031</span>, <span class="number">2584</span>, <span class="number">2008</span>, <span class="number">2928</span>, <span class="number">1010</span>, <span class="number">1998</span>, <span class="number">2031</span>, <span class="number">2596</span>, <span class="number">1999</span>, <span class="number">2654</span>, <span class="number">5803</span>, <span class="number">8504</span>, <span class="number">1012</span>, <span class="number">2280</span>, <span class="number">2447</span>, <span class="number">5899</span>, <span class="number">12385</span>, <span class="number">4324</span>, <span class="number">1996</span>, <span class="number">2501</span>, <span class="number">2005</span>, <span class="number">2087</span>, <span class="number">2685</span>, <span class="number">3195</span>, <span class="number">1999</span>, <span class="number">1037</span>, <span class="number">2309</span>, <span class="number">2208</span>, <span class="number">1997</span>, <span class="number">1996</span>, <span class="number">2977</span>, <span class="number">2007</span>, <span class="number">6079</span>, <span class="number">1012</span>, <span class="number">2348</span>, <span class="number">1996</span>, <span class="number">2136</span>, <span class="number">2038</span>, <span class="number">2196</span>, <span class="number">2180</span>, <span class="number">1996</span>, <span class="number">5803</span>, <span class="number">2977</span>, <span class="number">1010</span>, <span class="number">2027</span>, <span class="number">2020</span>, <span class="number">2315</span>, <span class="number">2011</span>, <span class="number">1996</span>, <span class="number">16254</span>, <span class="number">2015</span>, <span class="number">5188</span>, <span class="number">3192</span>, <span class="number">2004</span>, <span class="number">2120</span>, <span class="number">3966</span>, <span class="number">3807</span>, <span class="number">1012</span>, <span class="number">1996</span>, <span class="number">2136</span>, <span class="number">2038</span>, <span class="number">23339</span>, <span class="number">1037</span>, <span class="number">2193</span>, <span class="number">1997</span>, <span class="number">6314</span>, <span class="number">2015</span>, <span class="number">1997</span>, <span class="number">2193</span>, <span class="number">2028</span>, <span class="number">4396</span>, <span class="number">2780</span>, <span class="number">1010</span>, <span class="number">1996</span>, <span class="number">2087</span>, <span class="number">3862</span>, <span class="number">1997</span>, <span class="number">2029</span>, <span class="number">2001</span>, <span class="number">4566</span>, <span class="number">12389</span>, <span class="number">1005</span>, <span class="number">1055</span>, <span class="number">2501</span>, <span class="number">6070</span>, <span class="number">1011</span>, <span class="number">2208</span>, <span class="number">3045</span>, <span class="number">9039</span>, <span class="number">1999</span>, <span class="number">3326</span>, <span class="number">1012</span>, <span class="number">1996</span>, <span class="number">2136</span>, <span class="number">2038</span>, <span class="number">7854</span>, <span class="number">2019</span>, <span class="number">3176</span>, <span class="number">2809</span>, <span class="number">2193</span>, <span class="number">1011</span>, <span class="number">2028</span>, <span class="number">2780</span>, <span class="number">1010</span>, <span class="number">1998</span>, <span class="number">2216</span>, <span class="number">3157</span>, <span class="number">5222</span>, <span class="number">4635</span>, <span class="number">2117</span>, <span class="number">1010</span>, <span class="number">2000</span>, <span class="number">12389</span>, <span class="number">1005</span>, <span class="number">1055</span>, <span class="number">2184</span>, <span class="number">1010</span>, <span class="number">2035</span>, <span class="number">1011</span>, <span class="number">2051</span>, <span class="number">1999</span>, <span class="number">5222</span>, <span class="number">2114</span>, <span class="number">1996</span>, <span class="number">2327</span>, <span class="number">2136</span>, <span class="number">1012</span>, <span class="number">1996</span>, <span class="number">2136</span>, <span class="number">3248</span>, <span class="number">1999</span>, <span class="number">4397</span>, <span class="number">10601</span>, <span class="number">26429</span>, <span class="number">10531</span>, <span class="number">1006</span>, <span class="number">2306</span>, <span class="number">1996</span>, <span class="number">9493</span>, <span class="number">1052</span>, <span class="number">1012</span>, <span class="number">11830</span>, <span class="number">2415</span>, <span class="number">1007</span>, <span class="number">1010</span>, <span class="number">2029</span>, <span class="number">11882</span>, <span class="number">2005</span>, <span class="number">1996</span>, <span class="number">2927</span>, <span class="number">1997</span>, <span class="number">1996</span>, <span class="number">2268</span>, <span class="number">1516</span>, <span class="number">2230</span>, <span class="number">2161</span>, <span class="number">1012</span>, <span class="number">1996</span>, <span class="number">2136</span>, <span class="number">2003</span>, <span class="number">8868</span>, <span class="number">2011</span>, <span class="number">3505</span>, <span class="number">7987</span>, <span class="number">3240</span>, <span class="number">1010</span>, <span class="number">2040</span>, <span class="number">1010</span>, <span class="number">2004</span>, <span class="number">1997</span>, <span class="number">1996</span>, <span class="number">2297</span>, <span class="number">1516</span>, <span class="number">2321</span>, <span class="number">2161</span>, <span class="number">1010</span>, <span class="number">2010</span>, <span class="number">16249</span>, <span class="number">2012</span>, <span class="number">10289</span>, <span class="number">8214</span>, <span class="number">1010</span>, <span class="number">2038</span>, <span class="number">4719</span>, <span class="number">1037</span>, <span class="number">29327</span>, <span class="number">1011</span>, <span class="number">13913</span>, <span class="number">2501</span>, <span class="number">1012</span>, <span class="number">1999</span>, <span class="number">2268</span>, <span class="number">2027</span>, <span class="number">2020</span>, <span class="number">4778</span>, <span class="number">2000</span>, <span class="number">1996</span>, <span class="number">9152</span>, <span class="number">2102</span>, <span class="number">1010</span>, <span class="number">2073</span>, <span class="number">2027</span>, <span class="number">3935</span>, <span class="number">2000</span>, <span class="number">1996</span>, <span class="number">8565</span>, <span class="number">2021</span>, <span class="number">2020</span>, <span class="number">7854</span>, <span class="number">2011</span>, <span class="number">9502</span>, <span class="number">2110</span>, <span class="number">2040</span>, <span class="number">2253</span>, <span class="number">2006</span>, <span class="number">1998</span>, <span class="number">3786</span>, <span class="number">23950</span>, <span class="number">1999</span>, <span class="number">1996</span>, <span class="number">2528</span>, <span class="number">1012</span>, <span class="number">1996</span>, <span class="number">2230</span>, <span class="number">1516</span>, <span class="number">2340</span>, <span class="number">2136</span>, <span class="number">5531</span>, <span class="number">2049</span>, <span class="number">3180</span>, <span class="number">2161</span>, <span class="number">4396</span>, <span class="number">2193</span>, <span class="number">2698</span>, <span class="number">1999</span>, <span class="number">1996</span>, <span class="number">2406</span>, <span class="number">1010</span>, <span class="number">2007</span>, <span class="number">1037</span>, <span class="number">2501</span>, <span class="number">1997</span>, <span class="number">2423</span>, <span class="number">1516</span>, <span class="number">1019</span>, <span class="number">1010</span>, <span class="number">7987</span>, <span class="number">3240</span>, <span class="number">1005</span>, <span class="number">1055</span>, <span class="number">3587</span>, <span class="number">3442</span>, <span class="number">2322</span>, <span class="number">1011</span>, <span class="number">2663</span>, <span class="number">2161</span>, <span class="number">1010</span>, <span class="number">1998</span>, <span class="number">1037</span>, <span class="number">2117</span>, <span class="number">1011</span>, <span class="number">2173</span>, <span class="number">3926</span>, <span class="number">1999</span>, <span class="number">1996</span>, <span class="number">2502</span>, <span class="number">2264</span>, <span class="number">1012</span>, <span class="number">2076</span>, <span class="number">1996</span>, <span class="number">2297</span>, <span class="number">1011</span>, <span class="number">2321</span>, <span class="number">2161</span>, <span class="number">1010</span>, <span class="number">1996</span>, <span class="number">2136</span>, <span class="number">2253</span>, <span class="number">3590</span>, <span class="number">1011</span>, <span class="number">1020</span>, <span class="number">1998</span>, <span class="number">2180</span>, <span class="number">1996</span>, <span class="number">16222</span>, <span class="number">3034</span>, <span class="number">2977</span>, <span class="number">1010</span>, <span class="number">2101</span>, <span class="number">10787</span>, <span class="number">2000</span>, <span class="number">1996</span>, <span class="number">7069</span>, <span class="number">1022</span>, <span class="number">1010</span>, <span class="number">2073</span>, <span class="number">1996</span>, <span class="number">3554</span>, <span class="number">3493</span>, <span class="number">2439</span>, <span class="number">2006</span>, <span class="number">1037</span>, <span class="number">4771</span>, <span class="number">12610</span>, <span class="number">2121</span>, <span class="number">1011</span>, <span class="number">3786</span>, <span class="number">2121</span>, <span class="number">2114</span>, <span class="number">2059</span>, <span class="number">15188</span>, <span class="number">5612</span>, <span class="number">1012</span>, <span class="number">2419</span>, <span class="number">2011</span>, <span class="number">6452</span>, <span class="number">4433</span>, <span class="number">11214</span>, <span class="number">15333</span>, <span class="number">6862</span>, <span class="number">3946</span>, <span class="number">1998</span>, <span class="number">6986</span>, <span class="number">9530</span>, <span class="number">2532</span>, <span class="number">18533</span>, <span class="number">2239</span>, <span class="number">1010</span>, <span class="number">1996</span>, <span class="number">3554</span>, <span class="number">3493</span>, <span class="number">3786</span>, <span class="number">1996</span>, <span class="number">9523</span>, <span class="number">2120</span>, <span class="number">3410</span>, <span class="number">3804</span>, <span class="number">2630</span>, <span class="number">13664</span>, <span class="number">3807</span>, <span class="number">2076</span>, <span class="number">1996</span>, <span class="number">2161</span>, <span class="number">1012</span>, <span class="number">1996</span>, <span class="number">3590</span>, <span class="number">5222</span>, <span class="number">2020</span>, <span class="number">102</span>], [<span class="number">101</span>, <span class="number">2129</span>, <span class="number">2116</span>, <span class="number">5222</span>, <span class="number">2515</span>, <span class="number">1996</span>, <span class="number">10289</span>, <span class="number">8214</span>, <span class="number">2273</span>, <span class="number">1005</span>, <span class="number">1055</span>, <span class="number">3455</span>, <span class="number">2136</span>, <span class="number">2031</span>, <span class="number">1029</span>, <span class="number">102</span>, <span class="number">2528</span>, <span class="number">1012</span>, <span class="number">1996</span>, <span class="number">2230</span>, <span class="number">1516</span>, <span class="number">2340</span>, <span class="number">2136</span>, <span class="number">5531</span>, <span class="number">2049</span>, <span class="number">3180</span>, <span class="number">2161</span>, <span class="number">4396</span>, <span class="number">2193</span>, <span class="number">2698</span>, <span class="number">1999</span>, <span class="number">1996</span>, <span class="number">2406</span>, <span class="number">1010</span>, <span class="number">2007</span>, <span class="number">1037</span>, <span class="number">2501</span>, <span class="number">1997</span>, <span class="number">2423</span>, <span class="number">1516</span>, <span class="number">1019</span>, <span class="number">1010</span>, <span class="number">7987</span>, <span class="number">3240</span>, <span class="number">1005</span>, <span class="number">1055</span>, <span class="number">3587</span>, <span class="number">3442</span>, <span class="number">2322</span>, <span class="number">1011</span>, <span class="number">2663</span>, <span class="number">2161</span>, <span class="number">1010</span>, <span class="number">1998</span>, <span class="number">1037</span>, <span class="number">2117</span>, <span class="number">1011</span>, <span class="number">2173</span>, <span class="number">3926</span>, <span class="number">1999</span>, <span class="number">1996</span>, <span class="number">2502</span>, <span class="number">2264</span>, <span class="number">1012</span>, <span class="number">2076</span>, <span class="number">1996</span>, <span class="number">2297</span>, <span class="number">1011</span>, <span class="number">2321</span>, <span class="number">2161</span>, <span class="number">1010</span>, <span class="number">1996</span>, <span class="number">2136</span>, <span class="number">2253</span>, <span class="number">3590</span>, <span class="number">1011</span>, <span class="number">1020</span>, <span class="number">1998</span>, <span class="number">2180</span>, <span class="number">1996</span>, <span class="number">16222</span>, <span class="number">3034</span>, <span class="number">2977</span>, <span class="number">1010</span>, <span class="number">2101</span>, <span class="number">10787</span>, <span class="number">2000</span>, <span class="number">1996</span>, <span class="number">7069</span>, <span class="number">1022</span>, <span class="number">1010</span>, <span class="number">2073</span>, <span class="number">1996</span>, <span class="number">3554</span>, <span class="number">3493</span>, <span class="number">2439</span>, <span class="number">2006</span>, <span class="number">1037</span>, <span class="number">4771</span>, <span class="number">12610</span>, <span class="number">2121</span>, <span class="number">1011</span>, <span class="number">3786</span>, <span class="number">2121</span>, <span class="number">2114</span>, <span class="number">2059</span>, <span class="number">15188</span>, <span class="number">5612</span>, <span class="number">1012</span>, <span class="number">2419</span>, <span class="number">2011</span>, <span class="number">6452</span>, <span class="number">4433</span>, <span class="number">11214</span>, <span class="number">15333</span>, <span class="number">6862</span>, <span class="number">3946</span>, <span class="number">1998</span>, <span class="number">6986</span>, <span class="number">9530</span>, <span class="number">2532</span>, <span class="number">18533</span>, <span class="number">2239</span>, <span class="number">1010</span>, <span class="number">1996</span>, <span class="number">3554</span>, <span class="number">3493</span>, <span class="number">3786</span>, <span class="number">1996</span>, <span class="number">9523</span>, <span class="number">2120</span>, <span class="number">3410</span>, <span class="number">3804</span>, <span class="number">2630</span>, <span class="number">13664</span>, <span class="number">3807</span>, <span class="number">2076</span>, <span class="number">1996</span>, <span class="number">2161</span>, <span class="number">1012</span>, <span class="number">1996</span>, <span class="number">3590</span>, <span class="number">5222</span>, <span class="number">2020</span>, <span class="number">1996</span>, <span class="number">2087</span>, <span class="number">2011</span>, <span class="number">1996</span>, <span class="number">3554</span>, <span class="number">3493</span>, <span class="number">2136</span>, <span class="number">2144</span>, <span class="number">5316</span>, <span class="number">1011</span>, <span class="number">5641</span>, <span class="number">1012</span>, <span class="number">102</span>]], <span class="string">&#x27;attention_mask&#x27;</span>: [[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]], <span class="string">&#x27;offset_mapping&#x27;</span>: [[(<span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">2</span>), (<span class="number">3</span>, <span class="number">7</span>), (<span class="number">8</span>, <span class="number">11</span>), (<span class="number">12</span>, <span class="number">14</span>), (<span class="number">15</span>, <span class="number">20</span>), (<span class="number">21</span>, <span class="number">25</span>), (<span class="number">26</span>, <span class="number">30</span>), (<span class="number">31</span>, <span class="number">39</span>), (<span class="number">40</span>, <span class="number">45</span>), (<span class="number">46</span>, <span class="number">51</span>), (<span class="number">51</span>, <span class="number">52</span>), (<span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">8</span>), (<span class="number">9</span>, <span class="number">13</span>), (<span class="number">13</span>, <span class="number">16</span>), (<span class="number">17</span>, <span class="number">27</span>), (<span class="number">28</span>, <span class="number">34</span>), (<span class="number">35</span>, <span class="number">39</span>), (<span class="number">40</span>, <span class="number">45</span>), (<span class="number">45</span>, <span class="number">46</span>), (<span class="number">47</span>, <span class="number">57</span>), (<span class="number">58</span>, <span class="number">63</span>), (<span class="number">64</span>, <span class="number">67</span>), (<span class="number">68</span>, <span class="number">74</span>), (<span class="number">75</span>, <span class="number">81</span>), (<span class="number">82</span>, <span class="number">85</span>), (<span class="number">86</span>, <span class="number">95</span>), (<span class="number">96</span>, <span class="number">100</span>), (<span class="number">100</span>, <span class="number">101</span>), (<span class="number">102</span>, <span class="number">110</span>), (<span class="number">111</span>, <span class="number">116</span>), (<span class="number">117</span>, <span class="number">122</span>), (<span class="number">123</span>, <span class="number">127</span>), (<span class="number">128</span>, <span class="number">129</span>), (<span class="number">130</span>, <span class="number">141</span>), (<span class="number">142</span>, <span class="number">146</span>), (<span class="number">147</span>, <span class="number">148</span>), (<span class="number">148</span>, <span class="number">149</span>), (<span class="number">149</span>, <span class="number">150</span>), (<span class="number">150</span>, <span class="number">151</span>), (<span class="number">151</span>, <span class="number">152</span>), (<span class="number">153</span>, <span class="number">155</span>), (<span class="number">155</span>, <span class="number">157</span>), (<span class="number">158</span>, <span class="number">163</span>), (<span class="number">163</span>, <span class="number">164</span>), (<span class="number">164</span>, <span class="number">165</span>), (<span class="number">166</span>, <span class="number">169</span>), (<span class="number">169</span>, <span class="number">170</span>), (<span class="number">170</span>, <span class="number">175</span>), (<span class="number">176</span>, <span class="number">182</span>), (<span class="number">182</span>, <span class="number">183</span>), (<span class="number">183</span>, <span class="number">184</span>), (<span class="number">185</span>, <span class="number">196</span>), (<span class="number">197</span>, <span class="number">207</span>), (<span class="number">208</span>, <span class="number">213</span>), (<span class="number">214</span>, <span class="number">216</span>), (<span class="number">217</span>, <span class="number">220</span>), (<span class="number">221</span>, <span class="number">227</span>), (<span class="number">228</span>, <span class="number">230</span>), (<span class="number">231</span>, <span class="number">239</span>), (<span class="number">240</span>, <span class="number">244</span>), (<span class="number">245</span>, <span class="number">248</span>), (<span class="number">249</span>, <span class="number">256</span>), (<span class="number">256</span>, <span class="number">257</span>), (<span class="number">257</span>, <span class="number">258</span>), (<span class="number">259</span>, <span class="number">265</span>), (<span class="number">265</span>, <span class="number">266</span>), (<span class="number">267</span>, <span class="number">271</span>), (<span class="number">272</span>, <span class="number">281</span>), (<span class="number">282</span>, <span class="number">290</span>), (<span class="number">291</span>, <span class="number">294</span>), (<span class="number">295</span>, <span class="number">299</span>), (<span class="number">300</span>, <span class="number">304</span>), (<span class="number">305</span>, <span class="number">307</span>), (<span class="number">308</span>, <span class="number">311</span>), (<span class="number">312</span>, <span class="number">316</span>), (<span class="number">317</span>, <span class="number">319</span>), (<span class="number">320</span>, <span class="number">323</span>), (<span class="number">324</span>, <span class="number">332</span>), (<span class="number">333</span>, <span class="number">338</span>), (<span class="number">339</span>, <span class="number">342</span>), (<span class="number">343</span>, <span class="number">348</span>), (<span class="number">348</span>, <span class="number">349</span>), (<span class="number">350</span>, <span class="number">352</span>), (<span class="number">353</span>, <span class="number">356</span>), (<span class="number">357</span>, <span class="number">361</span>), (<span class="number">362</span>, <span class="number">364</span>), (<span class="number">365</span>, <span class="number">368</span>), (<span class="number">369</span>, <span class="number">380</span>), (<span class="number">381</span>, <span class="number">385</span>), (<span class="number">386</span>, <span class="number">390</span>), (<span class="number">391</span>, <span class="number">399</span>), (<span class="number">400</span>, <span class="number">403</span>), (<span class="number">404</span>, <span class="number">408</span>), (<span class="number">409</span>, <span class="number">411</span>), (<span class="number">412</span>, <span class="number">415</span>), (<span class="number">416</span>, <span class="number">420</span>), (<span class="number">420</span>, <span class="number">423</span>), (<span class="number">424</span>, <span class="number">432</span>), (<span class="number">432</span>, <span class="number">433</span>), (<span class="number">434</span>, <span class="number">439</span>), (<span class="number">440</span>, <span class="number">444</span>), (<span class="number">445</span>, <span class="number">448</span>), (<span class="number">448</span>, <span class="number">449</span>), (<span class="number">450</span>, <span class="number">453</span>), (<span class="number">454</span>, <span class="number">461</span>), (<span class="number">462</span>, <span class="number">469</span>), (<span class="number">470</span>, <span class="number">474</span>), (<span class="number">475</span>, <span class="number">479</span>), (<span class="number">480</span>, <span class="number">483</span>), (<span class="number">484</span>, <span class="number">489</span>), (<span class="number">490</span>, <span class="number">494</span>), (<span class="number">495</span>, <span class="number">502</span>), (<span class="number">503</span>, <span class="number">508</span>), (<span class="number">509</span>, <span class="number">512</span>), (<span class="number">513</span>, <span class="number">516</span>), (<span class="number">517</span>, <span class="number">522</span>), (<span class="number">523</span>, <span class="number">527</span>), (<span class="number">528</span>, <span class="number">532</span>), (<span class="number">533</span>, <span class="number">538</span>), (<span class="number">539</span>, <span class="number">544</span>), (<span class="number">545</span>, <span class="number">548</span>), (<span class="number">549</span>, <span class="number">553</span>), (<span class="number">553</span>, <span class="number">554</span>), (<span class="number">555</span>, <span class="number">558</span>), (<span class="number">559</span>, <span class="number">563</span>), (<span class="number">564</span>, <span class="number">570</span>), (<span class="number">571</span>, <span class="number">575</span>), (<span class="number">576</span>, <span class="number">580</span>), (<span class="number">581</span>, <span class="number">582</span>), (<span class="number">583</span>, <span class="number">590</span>), (<span class="number">591</span>, <span class="number">593</span>), (<span class="number">594</span>, <span class="number">597</span>), (<span class="number">598</span>, <span class="number">603</span>), (<span class="number">604</span>, <span class="number">606</span>), (<span class="number">607</span>, <span class="number">611</span>), (<span class="number">612</span>, <span class="number">616</span>), (<span class="number">616</span>, <span class="number">617</span>), (<span class="number">618</span>, <span class="number">622</span>), (<span class="number">623</span>, <span class="number">628</span>), (<span class="number">629</span>, <span class="number">633</span>), (<span class="number">634</span>, <span class="number">638</span>), (<span class="number">639</span>, <span class="number">644</span>), (<span class="number">645</span>, <span class="number">649</span>), (<span class="number">650</span>, <span class="number">655</span>), (<span class="number">656</span>, <span class="number">660</span>), (<span class="number">661</span>, <span class="number">668</span>), (<span class="number">668</span>, <span class="number">669</span>), (<span class="number">670</span>, <span class="number">677</span>), (<span class="number">678</span>, <span class="number">682</span>), (<span class="number">683</span>, <span class="number">686</span>), (<span class="number">687</span>, <span class="number">695</span>), (<span class="number">696</span>, <span class="number">701</span>), (<span class="number">702</span>, <span class="number">708</span>), (<span class="number">709</span>, <span class="number">715</span>), (<span class="number">716</span>, <span class="number">718</span>), (<span class="number">719</span>, <span class="number">722</span>), (<span class="number">723</span>, <span class="number">727</span>), (<span class="number">727</span>, <span class="number">728</span>), (<span class="number">0</span>, <span class="number">0</span>)], [(<span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">3</span>), (<span class="number">4</span>, <span class="number">8</span>), (<span class="number">9</span>, <span class="number">13</span>), (<span class="number">14</span>, <span class="number">18</span>), (<span class="number">19</span>, <span class="number">22</span>), (<span class="number">23</span>, <span class="number">28</span>), (<span class="number">29</span>, <span class="number">33</span>), (<span class="number">34</span>, <span class="number">37</span>), (<span class="number">37</span>, <span class="number">38</span>), (<span class="number">38</span>, <span class="number">39</span>), (<span class="number">40</span>, <span class="number">50</span>), (<span class="number">51</span>, <span class="number">55</span>), (<span class="number">56</span>, <span class="number">60</span>), (<span class="number">60</span>, <span class="number">61</span>), (<span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">3</span>), (<span class="number">4</span>, <span class="number">7</span>), (<span class="number">7</span>, <span class="number">8</span>), (<span class="number">8</span>, <span class="number">9</span>), (<span class="number">10</span>, <span class="number">20</span>), (<span class="number">21</span>, <span class="number">25</span>), (<span class="number">26</span>, <span class="number">29</span>), (<span class="number">30</span>, <span class="number">34</span>), (<span class="number">35</span>, <span class="number">36</span>), (<span class="number">36</span>, <span class="number">37</span>), (<span class="number">37</span>, <span class="number">40</span>), (<span class="number">41</span>, <span class="number">45</span>), (<span class="number">45</span>, <span class="number">46</span>), (<span class="number">47</span>, <span class="number">50</span>), (<span class="number">51</span>, <span class="number">53</span>), (<span class="number">54</span>, <span class="number">58</span>), (<span class="number">59</span>, <span class="number">61</span>), (<span class="number">62</span>, <span class="number">69</span>), (<span class="number">70</span>, <span class="number">73</span>), (<span class="number">74</span>, <span class="number">78</span>), (<span class="number">79</span>, <span class="number">86</span>), (<span class="number">87</span>, <span class="number">91</span>), (<span class="number">92</span>, <span class="number">96</span>), (<span class="number">96</span>, <span class="number">97</span>), (<span class="number">98</span>, <span class="number">101</span>), (<span class="number">102</span>, <span class="number">106</span>), (<span class="number">107</span>, <span class="number">115</span>), (<span class="number">116</span>, <span class="number">118</span>), (<span class="number">119</span>, <span class="number">121</span>), (<span class="number">122</span>, <span class="number">126</span>), (<span class="number">127</span>, <span class="number">138</span>), (<span class="number">138</span>, <span class="number">139</span>), (<span class="number">140</span>, <span class="number">146</span>), (<span class="number">147</span>, <span class="number">153</span>), (<span class="number">154</span>, <span class="number">160</span>), (<span class="number">161</span>, <span class="number">165</span>), (<span class="number">166</span>, <span class="number">171</span>), (<span class="number">172</span>, <span class="number">175</span>), (<span class="number">176</span>, <span class="number">182</span>), (<span class="number">183</span>, <span class="number">186</span>), (<span class="number">187</span>, <span class="number">191</span>), (<span class="number">192</span>, <span class="number">198</span>), (<span class="number">199</span>, <span class="number">205</span>), (<span class="number">206</span>, <span class="number">208</span>), (<span class="number">209</span>, <span class="number">210</span>), (<span class="number">211</span>, <span class="number">217</span>), (<span class="number">218</span>, <span class="number">222</span>), (<span class="number">223</span>, <span class="number">225</span>), (<span class="number">226</span>, <span class="number">229</span>), (<span class="number">230</span>, <span class="number">240</span>), (<span class="number">241</span>, <span class="number">245</span>), (<span class="number">246</span>, <span class="number">248</span>), (<span class="number">248</span>, <span class="number">249</span>), (<span class="number">250</span>, <span class="number">258</span>), (<span class="number">259</span>, <span class="number">262</span>), (<span class="number">263</span>, <span class="number">267</span>), (<span class="number">268</span>, <span class="number">271</span>), (<span class="number">272</span>, <span class="number">277</span>), (<span class="number">278</span>, <span class="number">281</span>), (<span class="number">282</span>, <span class="number">285</span>), (<span class="number">286</span>, <span class="number">290</span>), (<span class="number">291</span>, <span class="number">301</span>), (<span class="number">301</span>, <span class="number">302</span>), (<span class="number">303</span>, <span class="number">307</span>), (<span class="number">308</span>, <span class="number">312</span>), (<span class="number">313</span>, <span class="number">318</span>), (<span class="number">319</span>, <span class="number">321</span>), (<span class="number">322</span>, <span class="number">325</span>), (<span class="number">326</span>, <span class="number">330</span>), (<span class="number">330</span>, <span class="number">331</span>), (<span class="number">332</span>, <span class="number">340</span>), (<span class="number">341</span>, <span class="number">351</span>), (<span class="number">352</span>, <span class="number">354</span>), (<span class="number">355</span>, <span class="number">363</span>), (<span class="number">364</span>, <span class="number">373</span>), (<span class="number">374</span>, <span class="number">379</span>), (<span class="number">379</span>, <span class="number">380</span>), (<span class="number">381</span>, <span class="number">384</span>), (<span class="number">385</span>, <span class="number">389</span>), (<span class="number">390</span>, <span class="number">393</span>), (<span class="number">394</span>, <span class="number">406</span>), (<span class="number">407</span>, <span class="number">408</span>), (<span class="number">409</span>, <span class="number">415</span>), (<span class="number">416</span>, <span class="number">418</span>), (<span class="number">419</span>, <span class="number">424</span>), (<span class="number">424</span>, <span class="number">425</span>), (<span class="number">426</span>, <span class="number">428</span>), (<span class="number">429</span>, <span class="number">435</span>), (<span class="number">436</span>, <span class="number">439</span>), (<span class="number">440</span>, <span class="number">446</span>), (<span class="number">447</span>, <span class="number">452</span>), (<span class="number">452</span>, <span class="number">453</span>), (<span class="number">454</span>, <span class="number">457</span>), (<span class="number">458</span>, <span class="number">462</span>), (<span class="number">463</span>, <span class="number">470</span>), (<span class="number">471</span>, <span class="number">473</span>), (<span class="number">474</span>, <span class="number">479</span>), (<span class="number">480</span>, <span class="number">483</span>), (<span class="number">484</span>, <span class="number">490</span>), (<span class="number">491</span>, <span class="number">495</span>), (<span class="number">495</span>, <span class="number">496</span>), (<span class="number">496</span>, <span class="number">497</span>), (<span class="number">498</span>, <span class="number">504</span>), (<span class="number">505</span>, <span class="number">507</span>), (<span class="number">507</span>, <span class="number">508</span>), (<span class="number">508</span>, <span class="number">512</span>), (<span class="number">513</span>, <span class="number">520</span>), (<span class="number">521</span>, <span class="number">527</span>), (<span class="number">528</span>, <span class="number">530</span>), (<span class="number">531</span>, <span class="number">535</span>), (<span class="number">535</span>, <span class="number">536</span>), (<span class="number">537</span>, <span class="number">540</span>), (<span class="number">541</span>, <span class="number">545</span>), (<span class="number">546</span>, <span class="number">549</span>), (<span class="number">550</span>, <span class="number">556</span>), (<span class="number">557</span>, <span class="number">559</span>), (<span class="number">560</span>, <span class="number">570</span>), (<span class="number">571</span>, <span class="number">576</span>), (<span class="number">577</span>, <span class="number">583</span>), (<span class="number">583</span>, <span class="number">584</span>), (<span class="number">584</span>, <span class="number">587</span>), (<span class="number">588</span>, <span class="number">593</span>), (<span class="number">593</span>, <span class="number">594</span>), (<span class="number">595</span>, <span class="number">598</span>), (<span class="number">599</span>, <span class="number">604</span>), (<span class="number">605</span>, <span class="number">609</span>), (<span class="number">610</span>, <span class="number">614</span>), (<span class="number">615</span>, <span class="number">619</span>), (<span class="number">620</span>, <span class="number">626</span>), (<span class="number">626</span>, <span class="number">627</span>), (<span class="number">628</span>, <span class="number">630</span>), (<span class="number">631</span>, <span class="number">635</span>), (<span class="number">635</span>, <span class="number">636</span>), (<span class="number">636</span>, <span class="number">637</span>), (<span class="number">638</span>, <span class="number">640</span>), (<span class="number">640</span>, <span class="number">641</span>), (<span class="number">642</span>, <span class="number">645</span>), (<span class="number">645</span>, <span class="number">646</span>), (<span class="number">646</span>, <span class="number">650</span>), (<span class="number">651</span>, <span class="number">653</span>), (<span class="number">654</span>, <span class="number">658</span>), (<span class="number">659</span>, <span class="number">666</span>), (<span class="number">667</span>, <span class="number">670</span>), (<span class="number">671</span>, <span class="number">674</span>), (<span class="number">675</span>, <span class="number">679</span>), (<span class="number">679</span>, <span class="number">680</span>), (<span class="number">681</span>, <span class="number">684</span>), (<span class="number">685</span>, <span class="number">689</span>), (<span class="number">690</span>, <span class="number">695</span>), (<span class="number">696</span>, <span class="number">698</span>), (<span class="number">699</span>, <span class="number">704</span>), (<span class="number">705</span>, <span class="number">714</span>), (<span class="number">715</span>, <span class="number">722</span>), (<span class="number">723</span>, <span class="number">731</span>), (<span class="number">732</span>, <span class="number">733</span>), (<span class="number">733</span>, <span class="number">739</span>), (<span class="number">740</span>, <span class="number">743</span>), (<span class="number">744</span>, <span class="number">750</span>), (<span class="number">751</span>, <span class="number">752</span>), (<span class="number">752</span>, <span class="number">753</span>), (<span class="number">754</span>, <span class="number">759</span>), (<span class="number">760</span>, <span class="number">766</span>), (<span class="number">766</span>, <span class="number">767</span>), (<span class="number">767</span>, <span class="number">768</span>), (<span class="number">769</span>, <span class="number">774</span>), (<span class="number">775</span>, <span class="number">783</span>), (<span class="number">784</span>, <span class="number">787</span>), (<span class="number">788</span>, <span class="number">791</span>), (<span class="number">792</span>, <span class="number">801</span>), (<span class="number">802</span>, <span class="number">804</span>), (<span class="number">805</span>, <span class="number">808</span>), (<span class="number">809</span>, <span class="number">813</span>), (<span class="number">813</span>, <span class="number">814</span>), (<span class="number">814</span>, <span class="number">818</span>), (<span class="number">819</span>, <span class="number">825</span>), (<span class="number">825</span>, <span class="number">826</span>), (<span class="number">827</span>, <span class="number">830</span>), (<span class="number">831</span>, <span class="number">835</span>), (<span class="number">836</span>, <span class="number">838</span>), (<span class="number">839</span>, <span class="number">846</span>), (<span class="number">847</span>, <span class="number">849</span>), (<span class="number">850</span>, <span class="number">854</span>), (<span class="number">855</span>, <span class="number">857</span>), (<span class="number">857</span>, <span class="number">859</span>), (<span class="number">859</span>, <span class="number">860</span>), (<span class="number">861</span>, <span class="number">864</span>), (<span class="number">864</span>, <span class="number">865</span>), (<span class="number">866</span>, <span class="number">868</span>), (<span class="number">869</span>, <span class="number">871</span>), (<span class="number">872</span>, <span class="number">875</span>), (<span class="number">876</span>, <span class="number">880</span>), (<span class="number">880</span>, <span class="number">881</span>), (<span class="number">881</span>, <span class="number">883</span>), (<span class="number">884</span>, <span class="number">890</span>), (<span class="number">890</span>, <span class="number">891</span>), (<span class="number">892</span>, <span class="number">895</span>), (<span class="number">896</span>, <span class="number">905</span>), (<span class="number">906</span>, <span class="number">908</span>), (<span class="number">909</span>, <span class="number">914</span>), (<span class="number">915</span>, <span class="number">919</span>), (<span class="number">919</span>, <span class="number">920</span>), (<span class="number">921</span>, <span class="number">924</span>), (<span class="number">925</span>, <span class="number">933</span>), (<span class="number">934</span>, <span class="number">935</span>), (<span class="number">936</span>, <span class="number">939</span>), (<span class="number">939</span>, <span class="number">940</span>), (<span class="number">940</span>, <span class="number">943</span>), (<span class="number">944</span>, <span class="number">950</span>), (<span class="number">950</span>, <span class="number">951</span>), (<span class="number">952</span>, <span class="number">954</span>), (<span class="number">955</span>, <span class="number">959</span>), (<span class="number">960</span>, <span class="number">964</span>), (<span class="number">965</span>, <span class="number">969</span>), (<span class="number">970</span>, <span class="number">977</span>), (<span class="number">978</span>, <span class="number">980</span>), (<span class="number">981</span>, <span class="number">984</span>), (<span class="number">985</span>, <span class="number">987</span>), (<span class="number">987</span>, <span class="number">988</span>), (<span class="number">988</span>, <span class="number">989</span>), (<span class="number">990</span>, <span class="number">995</span>), (<span class="number">996</span>, <span class="number">1000</span>), (<span class="number">1001</span>, <span class="number">1009</span>), (<span class="number">1010</span>, <span class="number">1012</span>), (<span class="number">1013</span>, <span class="number">1016</span>), (<span class="number">1017</span>, <span class="number">1027</span>), (<span class="number">1028</span>, <span class="number">1031</span>), (<span class="number">1032</span>, <span class="number">1036</span>), (<span class="number">1037</span>, <span class="number">1043</span>), (<span class="number">1044</span>, <span class="number">1046</span>), (<span class="number">1047</span>, <span class="number">1051</span>), (<span class="number">1052</span>, <span class="number">1057</span>), (<span class="number">1058</span>, <span class="number">1061</span>), (<span class="number">1062</span>, <span class="number">1066</span>), (<span class="number">1067</span>, <span class="number">1069</span>), (<span class="number">1070</span>, <span class="number">1073</span>), (<span class="number">1074</span>, <span class="number">1078</span>), (<span class="number">1079</span>, <span class="number">1085</span>), (<span class="number">1086</span>, <span class="number">1088</span>), (<span class="number">1089</span>, <span class="number">1092</span>), (<span class="number">1093</span>, <span class="number">1105</span>), (<span class="number">1105</span>, <span class="number">1106</span>), (<span class="number">1107</span>, <span class="number">1110</span>), (<span class="number">1111</span>, <span class="number">1115</span>), (<span class="number">1115</span>, <span class="number">1116</span>), (<span class="number">1116</span>, <span class="number">1118</span>), (<span class="number">1119</span>, <span class="number">1123</span>), (<span class="number">1124</span>, <span class="number">1133</span>), (<span class="number">1134</span>, <span class="number">1137</span>), (<span class="number">1138</span>, <span class="number">1145</span>), (<span class="number">1146</span>, <span class="number">1152</span>), (<span class="number">1153</span>, <span class="number">1159</span>), (<span class="number">1160</span>, <span class="number">1166</span>), (<span class="number">1167</span>, <span class="number">1172</span>), (<span class="number">1173</span>, <span class="number">1175</span>), (<span class="number">1176</span>, <span class="number">1179</span>), (<span class="number">1180</span>, <span class="number">1187</span>), (<span class="number">1187</span>, <span class="number">1188</span>), (<span class="number">1189</span>, <span class="number">1193</span>), (<span class="number">1194</span>, <span class="number">1195</span>), (<span class="number">1196</span>, <span class="number">1202</span>), (<span class="number">1203</span>, <span class="number">1205</span>), (<span class="number">1206</span>, <span class="number">1208</span>), (<span class="number">1208</span>, <span class="number">1209</span>), (<span class="number">1209</span>, <span class="number">1210</span>), (<span class="number">1210</span>, <span class="number">1211</span>), (<span class="number">1212</span>, <span class="number">1214</span>), (<span class="number">1214</span>, <span class="number">1216</span>), (<span class="number">1216</span>, <span class="number">1217</span>), (<span class="number">1217</span>, <span class="number">1218</span>), (<span class="number">1219</span>, <span class="number">1224</span>), (<span class="number">1225</span>, <span class="number">1233</span>), (<span class="number">1234</span>, <span class="number">1236</span>), (<span class="number">1236</span>, <span class="number">1237</span>), (<span class="number">1237</span>, <span class="number">1240</span>), (<span class="number">1241</span>, <span class="number">1247</span>), (<span class="number">1247</span>, <span class="number">1248</span>), (<span class="number">1249</span>, <span class="number">1252</span>), (<span class="number">1253</span>, <span class="number">1254</span>), (<span class="number">1255</span>, <span class="number">1261</span>), (<span class="number">1261</span>, <span class="number">1262</span>), (<span class="number">1262</span>, <span class="number">1267</span>), (<span class="number">1268</span>, <span class="number">1274</span>), (<span class="number">1275</span>, <span class="number">1277</span>), (<span class="number">1278</span>, <span class="number">1281</span>), (<span class="number">1282</span>, <span class="number">1285</span>), (<span class="number">1286</span>, <span class="number">1290</span>), (<span class="number">1290</span>, <span class="number">1291</span>), (<span class="number">1292</span>, <span class="number">1298</span>), (<span class="number">1299</span>, <span class="number">1302</span>), (<span class="number">1303</span>, <span class="number">1307</span>), (<span class="number">1307</span>, <span class="number">1308</span>), (<span class="number">1308</span>, <span class="number">1310</span>), (<span class="number">1311</span>, <span class="number">1317</span>), (<span class="number">1317</span>, <span class="number">1318</span>), (<span class="number">1319</span>, <span class="number">1322</span>), (<span class="number">1323</span>, <span class="number">1327</span>), (<span class="number">1328</span>, <span class="number">1332</span>), (<span class="number">1333</span>, <span class="number">1335</span>), (<span class="number">1335</span>, <span class="number">1336</span>), (<span class="number">1336</span>, <span class="number">1337</span>), (<span class="number">1338</span>, <span class="number">1341</span>), (<span class="number">1342</span>, <span class="number">1345</span>), (<span class="number">1346</span>, <span class="number">1349</span>), (<span class="number">1350</span>, <span class="number">1353</span>), (<span class="number">1354</span>, <span class="number">1364</span>), (<span class="number">1365</span>, <span class="number">1375</span>), (<span class="number">1375</span>, <span class="number">1376</span>), (<span class="number">1377</span>, <span class="number">1382</span>), (<span class="number">1383</span>, <span class="number">1392</span>), (<span class="number">1393</span>, <span class="number">1395</span>), (<span class="number">1396</span>, <span class="number">1399</span>), (<span class="number">1400</span>, <span class="number">1405</span>), (<span class="number">1406</span>, <span class="number">1407</span>), (<span class="number">1407</span>, <span class="number">1408</span>), (<span class="number">1409</span>, <span class="number">1414</span>), (<span class="number">1415</span>, <span class="number">1418</span>), (<span class="number">1419</span>, <span class="number">1427</span>), (<span class="number">1428</span>, <span class="number">1433</span>), (<span class="number">1434</span>, <span class="number">1438</span>), (<span class="number">1439</span>, <span class="number">1441</span>), (<span class="number">1442</span>, <span class="number">1443</span>), (<span class="number">1444</span>, <span class="number">1450</span>), (<span class="number">1451</span>, <span class="number">1455</span>), (<span class="number">1455</span>, <span class="number">1457</span>), (<span class="number">1457</span>, <span class="number">1458</span>), (<span class="number">1458</span>, <span class="number">1462</span>), (<span class="number">1462</span>, <span class="number">1464</span>), (<span class="number">1465</span>, <span class="number">1472</span>), (<span class="number">1473</span>, <span class="number">1477</span>), (<span class="number">1478</span>, <span class="number">1488</span>), (<span class="number">1489</span>, <span class="number">1497</span>), (<span class="number">1497</span>, <span class="number">1498</span>), (<span class="number">1499</span>, <span class="number">1502</span>), (<span class="number">1503</span>, <span class="number">1505</span>), (<span class="number">1506</span>, <span class="number">1509</span>), (<span class="number">1510</span>, <span class="number">1515</span>), (<span class="number">1516</span>, <span class="number">1521</span>), (<span class="number">1522</span>, <span class="number">1524</span>), (<span class="number">1524</span>, <span class="number">1528</span>), (<span class="number">1529</span>, <span class="number">1534</span>), (<span class="number">1535</span>, <span class="number">1538</span>), (<span class="number">1539</span>, <span class="number">1542</span>), (<span class="number">1543</span>, <span class="number">1546</span>), (<span class="number">1546</span>, <span class="number">1548</span>), (<span class="number">1548</span>, <span class="number">1552</span>), (<span class="number">1552</span>, <span class="number">1554</span>), (<span class="number">1554</span>, <span class="number">1555</span>), (<span class="number">1556</span>, <span class="number">1559</span>), (<span class="number">1560</span>, <span class="number">1568</span>), (<span class="number">1569</span>, <span class="number">1574</span>), (<span class="number">1575</span>, <span class="number">1579</span>), (<span class="number">1580</span>, <span class="number">1583</span>), (<span class="number">1584</span>, <span class="number">1592</span>), (<span class="number">1593</span>, <span class="number">1601</span>), (<span class="number">1602</span>, <span class="number">1610</span>), (<span class="number">1611</span>, <span class="number">1615</span>), (<span class="number">1616</span>, <span class="number">1620</span>), (<span class="number">1621</span>, <span class="number">1627</span>), (<span class="number">1628</span>, <span class="number">1633</span>), (<span class="number">1634</span>, <span class="number">1640</span>), (<span class="number">1641</span>, <span class="number">1644</span>), (<span class="number">1645</span>, <span class="number">1651</span>), (<span class="number">1651</span>, <span class="number">1652</span>), (<span class="number">1653</span>, <span class="number">1656</span>), (<span class="number">1657</span>, <span class="number">1659</span>), (<span class="number">1660</span>, <span class="number">1664</span>), (<span class="number">1665</span>, <span class="number">1669</span>), (<span class="number">0</span>, <span class="number">0</span>)], [(<span class="number">0</span>, <span class="number">0</span>), (<span class="number">0</span>, <span class="number">3</span>), (<span class="number">4</span>, <span class="number">8</span>), (<span class="number">9</span>, <span class="number">13</span>), (<span class="number">14</span>, <span class="number">18</span>), (<span class="number">19</span>, <span class="number">22</span>), (<span class="number">23</span>, <span class="number">28</span>), (<span class="number">29</span>, <span class="number">33</span>), (<span class="number">34</span>, <span class="number">37</span>), (<span class="number">37</span>, <span class="number">38</span>), (<span class="number">38</span>, <span class="number">39</span>), (<span class="number">40</span>, <span class="number">50</span>), (<span class="number">51</span>, <span class="number">55</span>), (<span class="number">56</span>, <span class="number">60</span>), (<span class="number">60</span>, <span class="number">61</span>), (<span class="number">0</span>, <span class="number">0</span>), (<span class="number">1093</span>, <span class="number">1105</span>), (<span class="number">1105</span>, <span class="number">1106</span>), (<span class="number">1107</span>, <span class="number">1110</span>), (<span class="number">1111</span>, <span class="number">1115</span>), (<span class="number">1115</span>, <span class="number">1116</span>), (<span class="number">1116</span>, <span class="number">1118</span>), (<span class="number">1119</span>, <span class="number">1123</span>), (<span class="number">1124</span>, <span class="number">1133</span>), (<span class="number">1134</span>, <span class="number">1137</span>), (<span class="number">1138</span>, <span class="number">1145</span>), (<span class="number">1146</span>, <span class="number">1152</span>), (<span class="number">1153</span>, <span class="number">1159</span>), (<span class="number">1160</span>, <span class="number">1166</span>), (<span class="number">1167</span>, <span class="number">1172</span>), (<span class="number">1173</span>, <span class="number">1175</span>), (<span class="number">1176</span>, <span class="number">1179</span>), (<span class="number">1180</span>, <span class="number">1187</span>), (<span class="number">1187</span>, <span class="number">1188</span>), (<span class="number">1189</span>, <span class="number">1193</span>), (<span class="number">1194</span>, <span class="number">1195</span>), (<span class="number">1196</span>, <span class="number">1202</span>), (<span class="number">1203</span>, <span class="number">1205</span>), (<span class="number">1206</span>, <span class="number">1208</span>), (<span class="number">1208</span>, <span class="number">1209</span>), (<span class="number">1209</span>, <span class="number">1210</span>), (<span class="number">1210</span>, <span class="number">1211</span>), (<span class="number">1212</span>, <span class="number">1214</span>), (<span class="number">1214</span>, <span class="number">1216</span>), (<span class="number">1216</span>, <span class="number">1217</span>), (<span class="number">1217</span>, <span class="number">1218</span>), (<span class="number">1219</span>, <span class="number">1224</span>), (<span class="number">1225</span>, <span class="number">1233</span>), (<span class="number">1234</span>, <span class="number">1236</span>), (<span class="number">1236</span>, <span class="number">1237</span>), (<span class="number">1237</span>, <span class="number">1240</span>), (<span class="number">1241</span>, <span class="number">1247</span>), (<span class="number">1247</span>, <span class="number">1248</span>), (<span class="number">1249</span>, <span class="number">1252</span>), (<span class="number">1253</span>, <span class="number">1254</span>), (<span class="number">1255</span>, <span class="number">1261</span>), (<span class="number">1261</span>, <span class="number">1262</span>), (<span class="number">1262</span>, <span class="number">1267</span>), (<span class="number">1268</span>, <span class="number">1274</span>), (<span class="number">1275</span>, <span class="number">1277</span>), (<span class="number">1278</span>, <span class="number">1281</span>), (<span class="number">1282</span>, <span class="number">1285</span>), (<span class="number">1286</span>, <span class="number">1290</span>), (<span class="number">1290</span>, <span class="number">1291</span>), (<span class="number">1292</span>, <span class="number">1298</span>), (<span class="number">1299</span>, <span class="number">1302</span>), (<span class="number">1303</span>, <span class="number">1307</span>), (<span class="number">1307</span>, <span class="number">1308</span>), (<span class="number">1308</span>, <span class="number">1310</span>), (<span class="number">1311</span>, <span class="number">1317</span>), (<span class="number">1317</span>, <span class="number">1318</span>), (<span class="number">1319</span>, <span class="number">1322</span>), (<span class="number">1323</span>, <span class="number">1327</span>), (<span class="number">1328</span>, <span class="number">1332</span>), (<span class="number">1333</span>, <span class="number">1335</span>), (<span class="number">1335</span>, <span class="number">1336</span>), (<span class="number">1336</span>, <span class="number">1337</span>), (<span class="number">1338</span>, <span class="number">1341</span>), (<span class="number">1342</span>, <span class="number">1345</span>), (<span class="number">1346</span>, <span class="number">1349</span>), (<span class="number">1350</span>, <span class="number">1353</span>), (<span class="number">1354</span>, <span class="number">1364</span>), (<span class="number">1365</span>, <span class="number">1375</span>), (<span class="number">1375</span>, <span class="number">1376</span>), (<span class="number">1377</span>, <span class="number">1382</span>), (<span class="number">1383</span>, <span class="number">1392</span>), (<span class="number">1393</span>, <span class="number">1395</span>), (<span class="number">1396</span>, <span class="number">1399</span>), (<span class="number">1400</span>, <span class="number">1405</span>), (<span class="number">1406</span>, <span class="number">1407</span>), (<span class="number">1407</span>, <span class="number">1408</span>), (<span class="number">1409</span>, <span class="number">1414</span>), (<span class="number">1415</span>, <span class="number">1418</span>), (<span class="number">1419</span>, <span class="number">1427</span>), (<span class="number">1428</span>, <span class="number">1433</span>), (<span class="number">1434</span>, <span class="number">1438</span>), (<span class="number">1439</span>, <span class="number">1441</span>), (<span class="number">1442</span>, <span class="number">1443</span>), (<span class="number">1444</span>, <span class="number">1450</span>), (<span class="number">1451</span>, <span class="number">1455</span>), (<span class="number">1455</span>, <span class="number">1457</span>), (<span class="number">1457</span>, <span class="number">1458</span>), (<span class="number">1458</span>, <span class="number">1462</span>), (<span class="number">1462</span>, <span class="number">1464</span>), (<span class="number">1465</span>, <span class="number">1472</span>), (<span class="number">1473</span>, <span class="number">1477</span>), (<span class="number">1478</span>, <span class="number">1488</span>), (<span class="number">1489</span>, <span class="number">1497</span>), (<span class="number">1497</span>, <span class="number">1498</span>), (<span class="number">1499</span>, <span class="number">1502</span>), (<span class="number">1503</span>, <span class="number">1505</span>), (<span class="number">1506</span>, <span class="number">1509</span>), (<span class="number">1510</span>, <span class="number">1515</span>), (<span class="number">1516</span>, <span class="number">1521</span>), (<span class="number">1522</span>, <span class="number">1524</span>), (<span class="number">1524</span>, <span class="number">1528</span>), (<span class="number">1529</span>, <span class="number">1534</span>), (<span class="number">1535</span>, <span class="number">1538</span>), (<span class="number">1539</span>, <span class="number">1542</span>), (<span class="number">1543</span>, <span class="number">1546</span>), (<span class="number">1546</span>, <span class="number">1548</span>), (<span class="number">1548</span>, <span class="number">1552</span>), (<span class="number">1552</span>, <span class="number">1554</span>), (<span class="number">1554</span>, <span class="number">1555</span>), (<span class="number">1556</span>, <span class="number">1559</span>), (<span class="number">1560</span>, <span class="number">1568</span>), (<span class="number">1569</span>, <span class="number">1574</span>), (<span class="number">1575</span>, <span class="number">1579</span>), (<span class="number">1580</span>, <span class="number">1583</span>), (<span class="number">1584</span>, <span class="number">1592</span>), (<span class="number">1593</span>, <span class="number">1601</span>), (<span class="number">1602</span>, <span class="number">1610</span>), (<span class="number">1611</span>, <span class="number">1615</span>), (<span class="number">1616</span>, <span class="number">1620</span>), (<span class="number">1621</span>, <span class="number">1627</span>), (<span class="number">1628</span>, <span class="number">1633</span>), (<span class="number">1634</span>, <span class="number">1640</span>), (<span class="number">1641</span>, <span class="number">1644</span>), (<span class="number">1645</span>, <span class="number">1651</span>), (<span class="number">1651</span>, <span class="number">1652</span>), (<span class="number">1653</span>, <span class="number">1656</span>), (<span class="number">1657</span>, <span class="number">1659</span>), (<span class="number">1660</span>, <span class="number">1664</span>), (<span class="number">1665</span>, <span class="number">1669</span>), (<span class="number">1670</span>, <span class="number">1673</span>), (<span class="number">1674</span>, <span class="number">1678</span>), (<span class="number">1679</span>, <span class="number">1681</span>), (<span class="number">1682</span>, <span class="number">1685</span>), (<span class="number">1686</span>, <span class="number">1694</span>), (<span class="number">1695</span>, <span class="number">1700</span>), (<span class="number">1701</span>, <span class="number">1705</span>), (<span class="number">1706</span>, <span class="number">1711</span>), (<span class="number">1712</span>, <span class="number">1716</span>), (<span class="number">1716</span>, <span class="number">1717</span>), (<span class="number">1717</span>, <span class="number">1719</span>), (<span class="number">1719</span>, <span class="number">1720</span>), (<span class="number">0</span>, <span class="number">0</span>)]], <span class="string">&#x27;overflow_to_sample_mapping&#x27;</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>]&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="取小型数据集的方式">2.4 取小型数据集的方式</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">small_train_dataset = tokenized_datasets[<span class="string">&quot;train&quot;</span>].shuffle(seed=<span class="number">42</span>).select(<span class="built_in">range</span>(<span class="number">100</span>))</span><br><span class="line"></span><br><span class="line">output：Dataset(&#123;</span><br><span class="line">    features: [<span class="string">&#x27;input_ids&#x27;</span>, <span class="string">&#x27;attention_mask&#x27;</span>, <span class="string">&#x27;start_positions&#x27;</span>, <span class="string">&#x27;end_positions&#x27;</span>],</span><br><span class="line">    num_rows: <span class="number">100</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>这里面的select方法是会选取1000行数据，然后返回一个dataset的子集</p>
<h2 id="模型评估">3 模型评估</h2>
<p><strong>单个特征处理</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">n_best_size = <span class="number">20</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">start_logits = output.start_logits[<span class="number">0</span>].cpu().numpy()</span><br><span class="line">end_logits = output.end_logits[<span class="number">0</span>].cpu().numpy()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取最佳的起始和结束位置的索引：</span></span><br><span class="line">start_indexes = np.argsort(start_logits)[-<span class="number">1</span> : -n_best_size - <span class="number">1</span> : -<span class="number">1</span>].tolist()</span><br><span class="line"><span class="comment"># np.argsort 是对start_logit中的元素从小到大排列，然后再用切片的形式从大到小排列,最后用列表的形式返回</span></span><br><span class="line">end_indexes = np.argsort(end_logits)[-<span class="number">1</span> : -n_best_size - <span class="number">1</span> : -<span class="number">1</span>].tolist()</span><br><span class="line"></span><br><span class="line">valid_answers = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历起始位置和结束位置的索引组合</span></span><br><span class="line"><span class="keyword">for</span> start_index <span class="keyword">in</span> start_indexes:</span><br><span class="line">    <span class="keyword">for</span> end_index <span class="keyword">in</span> end_indexes:</span><br><span class="line">        <span class="keyword">if</span> start_index &lt;= end_index:  <span class="comment"># 需要进一步测试以检查答案是否在上下文中</span></span><br><span class="line">            valid_answers.append(</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">&quot;score&quot;</span>: start_logits[start_index] + end_logits[end_index],</span><br><span class="line">                    <span class="string">&quot;text&quot;</span>: <span class="string">&quot;&quot;</span>  <span class="comment"># 我们需要找到一种方法来获取与上下文中答案对应的原始子字符串</span></span><br><span class="line">                &#125;</span><br><span class="line">            )</span><br></pre></td></tr></table></figure>
<p><strong>如何检查给定的跨度是否在上下文中（而不是问题中），以及如何获取其中的文本</strong></p>
<ul>
<li>生成该特征的示例的ID（因为每个示例可以生成多个特征，如前所示）</li>
<li>偏移映射，它将为我们提供从标记索引到上下文中字符位置的映射。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">prepare_validation_features</span>(<span class="params">examples</span>):</span><br><span class="line">    <span class="comment"># 一些问题的左侧有很多空白，这些空白并不有用且会导致上下文截断失败（分词后的问题会占用很多空间）。</span></span><br><span class="line">    <span class="comment"># 因此我们移除这些左侧空白, 列表推导式</span></span><br><span class="line">    examples[<span class="string">&quot;question&quot;</span>] = [q.lstrip() <span class="keyword">for</span> q <span class="keyword">in</span> examples[<span class="string">&quot;question&quot;</span>]]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 使用截断和可能的填充对我们的示例进行分词，但使用步长保留溢出的令牌。这导致一个长上下文的示例可能产生</span></span><br><span class="line">    <span class="comment"># 几个特征，每个特征的上下文都会稍微与前一个特征的上下文重叠。</span></span><br><span class="line">    tokenized_examples = tokenizer(</span><br><span class="line">        examples[<span class="string">&quot;question&quot;</span> <span class="keyword">if</span> pad_on_right <span class="keyword">else</span> <span class="string">&quot;context&quot;</span>],</span><br><span class="line">        examples[<span class="string">&quot;context&quot;</span> <span class="keyword">if</span> pad_on_right <span class="keyword">else</span> <span class="string">&quot;question&quot;</span>],</span><br><span class="line">        truncation=<span class="string">&quot;only_second&quot;</span> <span class="keyword">if</span> pad_on_right <span class="keyword">else</span> <span class="string">&quot;only_first&quot;</span>,</span><br><span class="line">        max_length=max_length,</span><br><span class="line">        stride=doc_stride,</span><br><span class="line">        return_overflowing_tokens=<span class="literal">True</span>,</span><br><span class="line">        return_offsets_mapping=<span class="literal">True</span>,</span><br><span class="line">        padding=<span class="string">&quot;max_length&quot;</span>,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 由于一个示例在上下文很长时可能会产生几个特征，我们需要一个从特征映射到其对应示例的映射。这个键就是为了这个目的。</span></span><br><span class="line">    sample_mapping = tokenized_examples.pop(<span class="string">&quot;overflow_to_sample_mapping&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 我们保留产生这个特征的示例ID，并且会存储偏移映射。</span></span><br><span class="line">    tokenized_examples[<span class="string">&quot;example_id&quot;</span>] = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tokenized_examples[<span class="string">&quot;input_ids&quot;</span>])):</span><br><span class="line">        <span class="comment"># 获取与该示例对应的序列（以了解哪些是上下文，哪些是问题）。</span></span><br><span class="line">        sequence_ids = tokenized_examples.sequence_ids(i)</span><br><span class="line">        context_index = <span class="number">1</span> <span class="keyword">if</span> pad_on_right <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 一个示例可以产生几个文本段，这里是包含该文本段的示例的索引。</span></span><br><span class="line">        sample_index = sample_mapping[i]</span><br><span class="line">        tokenized_examples[<span class="string">&quot;example_id&quot;</span>].append(examples[<span class="string">&quot;id&quot;</span>][sample_index])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将不属于上下文的偏移映射设置为None，以便容易确定一个令牌位置是否属于上下文。</span></span><br><span class="line">        tokenized_examples[<span class="string">&quot;offset_mapping&quot;</span>][i] = [</span><br><span class="line">            (o <span class="keyword">if</span> sequence_ids[k] == context_index <span class="keyword">else</span> <span class="literal">None</span>)</span><br><span class="line">            <span class="keyword">for</span> k, o <span class="keyword">in</span> <span class="built_in">enumerate</span>(tokenized_examples[<span class="string">&quot;offset_mapping&quot;</span>][i])</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tokenized_examples</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>将prepare_validation_features 应用到整个验证集</strong>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">validation_features = datasets[<span class="string">&quot;validation&quot;</span>].<span class="built_in">map</span>(</span><br><span class="line">    prepare_validation_features,</span><br><span class="line">    batched=<span class="literal">True</span>,</span><br><span class="line">    remove_columns=datasets[<span class="string">&quot;validation&quot;</span>].column_names</span><br><span class="line">)</span><br></pre></td></tr></table></figure> <strong>用 Trainer.predict
方法抓取所有特征的预测</strong></p>
<blockquote>
<p>raw_predictions = trainer.predict(validation_features)</p>
</blockquote>
<p><strong>Trainer 会隐藏模型不使用的列（这里是example_id and
offseer_mapping）</strong></p>
<blockquote>
<p>validation_features.set_format(type=validation_features.format["type"],
columns=list(validation_features.features.keys()))</p>
</blockquote>
<p>由于在偏移映射中，当它对应于问题的一部分时，我们将其设置为None，因此可以轻松检查答案是否完全在上下文中。我们还可以从考虑中排除非常长的答案（可以调整的超参数）。</p>
<ul>
<li>首先从模型输出中获取起始和结束的逻辑值（logits），这些值表明答案在文本中可能开始和结束的位置。</li>
<li>然后，它使用偏移映射（offset_mapping）来找到这些逻辑值在原始文本中的具体位置。</li>
<li>接下来，代码遍历可能的开始和结束索引组合，排除那些不在上下文范围内或长度不合适的答案。</li>
<li>对于有效的答案，它计算出一个分数（基于开始和结束逻辑值的和），并将答案及其分数存储起来。</li>
<li>最后，它根据分数对答案进行排序，并返回得分最高的几个答案。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">max_answer_length = <span class="number">30</span></span><br><span class="line">start_logits = output.start_logits[<span class="number">0</span>].cpu().numpy()</span><br><span class="line">end_logits = output.end_logits[<span class="number">0</span>].cpu().numpy()</span><br><span class="line">offset_mapping = validation_features[<span class="number">0</span>][<span class="string">&quot;offset_mapping&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一个特征来自第一个示例。对于更一般的情况，我们需要将example_id匹配到一个示例索引</span></span><br><span class="line">context = datasets[<span class="string">&quot;validation&quot;</span>][<span class="number">0</span>][<span class="string">&quot;context&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 收集最佳开始/结束逻辑的索引：</span></span><br><span class="line">start_indexes = np.argsort(start_logits)[-<span class="number">1</span> : -n_best_size - <span class="number">1</span> : -<span class="number">1</span>].tolist()</span><br><span class="line">end_indexes = np.argsort(end_logits)[-<span class="number">1</span> : -n_best_size - <span class="number">1</span> : -<span class="number">1</span>].tolist()</span><br><span class="line">valid_answers = []</span><br><span class="line"><span class="keyword">for</span> start_index <span class="keyword">in</span> start_indexes:</span><br><span class="line">    <span class="keyword">for</span> end_index <span class="keyword">in</span> end_indexes:</span><br><span class="line">        <span class="comment"># 不考虑超出范围的答案，原因是索引超出范围或对应于输入ID的部分不在上下文中。</span></span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">            start_index &gt;= <span class="built_in">len</span>(offset_mapping)</span><br><span class="line">            <span class="keyword">or</span> end_index &gt;= <span class="built_in">len</span>(offset_mapping)</span><br><span class="line">            <span class="keyword">or</span> offset_mapping[start_index] <span class="keyword">is</span> <span class="literal">None</span></span><br><span class="line">            <span class="keyword">or</span> offset_mapping[end_index] <span class="keyword">is</span> <span class="literal">None</span></span><br><span class="line">        ):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="comment"># 不考虑长度小于0或大于max_answer_length的答案。</span></span><br><span class="line">        <span class="keyword">if</span> end_index &lt; start_index <span class="keyword">or</span> end_index - start_index + <span class="number">1</span> &gt; max_answer_length:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> start_index &lt;= end_index: <span class="comment"># 我们需要细化这个测试，以检查答案是否在上下文中</span></span><br><span class="line">            start_char = offset_mapping[start_index][<span class="number">0</span>]</span><br><span class="line">            end_char = offset_mapping[end_index][<span class="number">1</span>]</span><br><span class="line">            valid_answers.append(</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">&quot;score&quot;</span>: start_logits[start_index] + end_logits[end_index],</span><br><span class="line">                    <span class="string">&quot;text&quot;</span>: context[start_char: end_char]</span><br><span class="line">                &#125;</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">valid_answers = <span class="built_in">sorted</span>(valid_answers, key=<span class="keyword">lambda</span> x: x[<span class="string">&quot;score&quot;</span>], reverse=<span class="literal">True</span>)[:n_best_size] </span><br><span class="line"><span class="comment"># 用排序函数，然后用lambda 根据score从大到小排序，然后切片前n_best_size</span></span><br><span class="line">valid_answers</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>实例索引到其特征索引的映射关系</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line">examples = datasets[<span class="string">&quot;validation&quot;</span>]</span><br><span class="line">features = validation_features</span><br><span class="line"></span><br><span class="line">example_id_to_index = &#123;k: i <span class="keyword">for</span> i, k <span class="keyword">in</span> <span class="built_in">enumerate</span>(examples[<span class="string">&quot;id&quot;</span>])&#125; </span><br><span class="line"><span class="comment">#字典推导式</span></span><br><span class="line">features_per_example = collections.defaultdict(<span class="built_in">list</span>)</span><br><span class="line"><span class="comment">#创建一个defaultdict对象features_per_example，默认值是一个空列表。这意味着如果访问一个不存在的键，它将自动创建一个对应的空列表</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, feature <span class="keyword">in</span> <span class="built_in">enumerate</span>(features):</span><br><span class="line">    features_per_example[example_id_to_index[feature[<span class="string">&quot;example_id&quot;</span>]]].append(i)</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>当squad_v2 = True时，有一定概率出现不可能的答案（impossible
answer)。</p>
<p>上面的代码仅保留在上下文中的答案，我们还需要获取不可能答案的分数（其起始和结束索引对应于CLS标记的索引）。</p>
<p>当一个示例生成多个特征时，我们必须在所有特征中的不可能答案都预测出现不可能答案时（因为一个特征可能之所以能够预测出不可能答案，是因为答案不在它可以访问的上下文部分），这就是为什么一个示例中不可能答案的分数是该示例生成的每个特征中的不可能答案的分数的最小值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> tqdm.auto <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">postprocess_qa_predictions</span>(<span class="params">examples, features, raw_predictions, n_best_size = <span class="number">20</span>, max_answer_length = <span class="number">30</span></span>):</span><br><span class="line">    all_start_logits, all_end_logits = raw_predictions</span><br><span class="line">    <span class="comment"># 构建一个从示例到其对应特征的映射。</span></span><br><span class="line">    example_id_to_index = &#123;k: i <span class="keyword">for</span> i, k <span class="keyword">in</span> <span class="built_in">enumerate</span>(examples[<span class="string">&quot;id&quot;</span>])&#125;</span><br><span class="line">    features_per_example = collections.defaultdict(<span class="built_in">list</span>)</span><br><span class="line">    <span class="keyword">for</span> i, feature <span class="keyword">in</span> <span class="built_in">enumerate</span>(features):</span><br><span class="line">        features_per_example[example_id_to_index[feature[<span class="string">&quot;example_id&quot;</span>]]].append(i)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 我们需要填充的字典。</span></span><br><span class="line">    predictions = collections.OrderedDict()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 日志记录。</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;正在后处理 <span class="subst">&#123;<span class="built_in">len</span>(examples)&#125;</span> 个示例的预测，这些预测分散在 <span class="subst">&#123;<span class="built_in">len</span>(features)&#125;</span> 个特征中。&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 遍历所有示例！</span></span><br><span class="line">    <span class="keyword">for</span> example_index, example <span class="keyword">in</span> <span class="built_in">enumerate</span>(tqdm(examples)):</span><br><span class="line">        <span class="comment"># 这些是与当前示例关联的特征的索引。</span></span><br><span class="line">        feature_indices = features_per_example[example_index]</span><br><span class="line"></span><br><span class="line">        min_null_score = <span class="literal">None</span> <span class="comment"># 仅在squad_v2为True时使用。</span></span><br><span class="line">        valid_answers = []</span><br><span class="line">        </span><br><span class="line">        context = example[<span class="string">&quot;context&quot;</span>]</span><br><span class="line">        <span class="comment"># 遍历与当前示例关联的所有特征。</span></span><br><span class="line">        <span class="keyword">for</span> feature_index <span class="keyword">in</span> feature_indices:</span><br><span class="line">            <span class="comment"># 我们获取模型对这个特征的预测。</span></span><br><span class="line">            start_logits = all_start_logits[feature_index]</span><br><span class="line">            end_logits = all_end_logits[feature_index]</span><br><span class="line">            <span class="comment"># 这将允许我们将logits中的某些位置映射到原始上下文中的文本跨度。</span></span><br><span class="line">            offset_mapping = features[feature_index][<span class="string">&quot;offset_mapping&quot;</span>]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 更新最小空预测。</span></span><br><span class="line">            cls_index = features[feature_index][<span class="string">&quot;input_ids&quot;</span>].index(tokenizer.cls_token_id)</span><br><span class="line">            feature_null_score = start_logits[cls_index] + end_logits[cls_index]</span><br><span class="line">            <span class="keyword">if</span> min_null_score <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> min_null_score &lt; feature_null_score:</span><br><span class="line">                min_null_score = feature_null_score</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 浏览所有的最佳开始和结束logits，为 `n_best_size` 个最佳选择。</span></span><br><span class="line">            start_indexes = np.argsort(start_logits)[-<span class="number">1</span> : -n_best_size - <span class="number">1</span> : -<span class="number">1</span>].tolist()</span><br><span class="line">            end_indexes = np.argsort(end_logits)[-<span class="number">1</span> : -n_best_size - <span class="number">1</span> : -<span class="number">1</span>].tolist()</span><br><span class="line">            <span class="keyword">for</span> start_index <span class="keyword">in</span> start_indexes:</span><br><span class="line">                <span class="keyword">for</span> end_index <span class="keyword">in</span> end_indexes:</span><br><span class="line">                    <span class="comment"># 不考虑超出范围的答案，原因是索引超出范围或对应于输入ID的部分不在上下文中。</span></span><br><span class="line">                    <span class="keyword">if</span> (</span><br><span class="line">                        start_index &gt;= <span class="built_in">len</span>(offset_mapping)</span><br><span class="line">                        <span class="keyword">or</span> end_index &gt;= <span class="built_in">len</span>(offset_mapping)</span><br><span class="line">                        <span class="keyword">or</span> offset_mapping[start_index] <span class="keyword">is</span> <span class="literal">None</span></span><br><span class="line">                        <span class="keyword">or</span> offset_mapping[end_index] <span class="keyword">is</span> <span class="literal">None</span></span><br><span class="line">                    ):</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    <span class="comment"># 不考虑长度小于0或大于max_answer_length的答案。</span></span><br><span class="line">                    <span class="keyword">if</span> end_index &lt; start_index <span class="keyword">or</span> end_index - start_index + <span class="number">1</span> &gt; max_answer_length:</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                    start_char = offset_mapping[start_index][<span class="number">0</span>]</span><br><span class="line">                    end_char = offset_mapping[end_index][<span class="number">1</span>]</span><br><span class="line">                    valid_answers.append(</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="string">&quot;score&quot;</span>: start_logits[start_index] + end_logits[end_index],</span><br><span class="line">                            <span class="string">&quot;text&quot;</span>: context[start_char: end_char]</span><br><span class="line">                        &#125;</span><br><span class="line">                    )</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(valid_answers) &gt; <span class="number">0</span>:</span><br><span class="line">            best_answer = <span class="built_in">sorted</span>(valid_answers, key=<span class="keyword">lambda</span> x: x[<span class="string">&quot;score&quot;</span>], reverse=<span class="literal">True</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 在极少数情况下我们没有一个非空预测，我们创建一个假预测以避免失败。</span></span><br><span class="line">            best_answer = &#123;<span class="string">&quot;text&quot;</span>: <span class="string">&quot;&quot;</span>, <span class="string">&quot;score&quot;</span>: <span class="number">0.0</span>&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 选择我们的最终答案：最佳答案或空答案（仅适用于squad_v2）</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> squad_v2:</span><br><span class="line">            predictions[example[<span class="string">&quot;id&quot;</span>]] = best_answer[<span class="string">&quot;text&quot;</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            answer = best_answer[<span class="string">&quot;text&quot;</span>] <span class="keyword">if</span> best_answer[<span class="string">&quot;score&quot;</span>] &gt; min_null_score <span class="keyword">else</span> <span class="string">&quot;&quot;</span></span><br><span class="line">            predictions[example[<span class="string">&quot;id&quot;</span>]] = answer</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> predictions</span><br></pre></td></tr></table></figure>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li
id="fn1"><p><font size = 1><a id= "对抗性"></a>对抗性通常指的是对抗性攻击和对抗性样本。对抗性样本是指经过精心设计，能误导机器学习模型或神经网络，使其做出错误预测的数据。例如，在图像识别中，微小的扰动可以使模型错误分类图像.</font><a
href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="Jason Li WeChat Pay">
        <span>WeChat Pay</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="Jason Li Alipay">
        <span>Alipay</span>
      </div>
      <div>
        <img src="/images/paypal.png" alt="Jason Li PayPal">
        <span>PayPal</span>
      </div>
      <div>
        <img src="/images/bitcoin.png" alt="Jason Li Bitcoin">
        <span>Bitcoin</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>Jason Li
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="http://example.com/2024/08/11/Basic%20Conception/" title="Q&amp;A dataset Fine-tune">http://example.com/2024/08/11/Basic Conception/</a>
  </li>
  <li class="post-copyright-license">
      <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/username">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://t.me/channel_name">
            <span class="icon">
              <i class="fab fa-telegram"></i>
            </span>

            <span class="label">Telegram</span>
          </a>
      </div>

      <div class="social-item">
          <span class="social-link">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </span>

          <img class="social-item-img" src="/images/wechat_channel.png">
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://www.zhihu.com/people/username">
            <span class="icon">
              <i class="fab fa-zhihu"></i>
            </span>

            <span class="label">Zhihu</span>
          </a>
      </div>
  </div>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/08/11/hello-world/" rel="prev" title="Hello World">
                  <i class="fa fa-angle-left"></i> Hello World
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/08/12/%E5%9B%BE%E7%BB%84/" rel="next" title="">
                   <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="SOHUCS" sid="20d24e3db4486a54af4fc258a9dc5374"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2021 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Jason Li</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">8k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">30 mins.</span>
  </span>
</div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL0xlc3RlckxKUw==" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  
  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.3.0/pdfobject.min.js","integrity":"sha256-JJZNsid68vnh3/zyj0lY9BN5ynxVX/12XgOa1TlaYN0="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.0/mermaid.min.js","integrity":"sha256-stuqcu2FrjYCXDOytWFA5SoUE/r3nkp6gTglzNSlavU="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>

  <script class="next-config" data-name="wavedrom" type="application/json">{"enable":true,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/wavedrom/3.5.0/wavedrom.min.js","integrity":"sha256-INLAoJc6quTNfiMWkGZniYO2cxE8mHpddnLow1m6RFs="}}</script>
  <script class="next-config" data-name="wavedrom_skin" type="application/json">{"enable":true,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/wavedrom/3.5.0/skins/default.js","integrity":"sha256-fduc/Zszk5ezWws2uInY/ALWVmIrmV6VTgXbsYSReFI="}}</script>
  <script src="/js/third-party/tags/wavedrom.js"></script>

  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  




  <script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"http://example.com/2024/08/11/Basic%20Conception/"}</script>
  <script src="/js/third-party/quicklink.js"></script>
<script class="next-config" data-name="changyan" type="application/json">{"enable":true,"appid":"cyxrwJrPT","appkey":"fb57f6b1513b3dc0aa42e426bb51ffab","count":true}</script>
<script src="/js/third-party/comments/changyan.js"></script>

</body>
</html>
